<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.2">
<title>Dependency Injection</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement when using as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Dependency Injection</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_injection">1. Injection</a>
<ul class="sectlevel2">
<li><a href="#_resource_injection">1.1. Resource Injection</a></li>
<li><a href="#_dependency_injection">1.2. Dependency Injection</a></li>
<li><a href="#_the_main_differences_between_resource_injection_and_dependency_injection">1.3. The Main Differences between Resource Injection and Dependency Injection</a></li>
</ul>
</li>
<li><a href="#_introduction_to_jakarta_contexts_and_dependency_injection">2. Introduction to Jakarta Contexts and Dependency Injection</a>
<ul class="sectlevel2">
<li><a href="#_getting_started">2.1. Getting Started</a></li>
<li><a href="#_overview_of_cdi">2.2. Overview of CDI</a></li>
<li><a href="#_about_beans">2.3. About Beans</a></li>
<li><a href="#_about_cdi_managed_beans">2.4. About CDI Managed Beans</a></li>
<li><a href="#_beans_as_injectable_objects">2.5. Beans as Injectable Objects</a></li>
<li><a href="#_using_qualifiers">2.6. Using Qualifiers</a></li>
<li><a href="#_injecting_beans">2.7. Injecting Beans</a></li>
<li><a href="#_using_scopes">2.8. Using Scopes</a></li>
<li><a href="#_giving_beans_el_names">2.9. Giving Beans EL Names</a></li>
<li><a href="#_adding_setter_and_getter_methods">2.10. Adding Setter and Getter Methods</a></li>
<li><a href="#_using_a_managed_bean_in_a_facelets_page">2.11. Using a Managed Bean in a Facelets Page</a></li>
<li><a href="#_injecting_objects_by_using_producer_methods">2.12. Injecting Objects by Using Producer Methods</a></li>
<li><a href="#_configuring_a_cdi_application">2.13. Configuring a CDI Application</a></li>
<li><a href="#_using_the_postconstruct_and_predestroy_annotations_with_cdi_managed_bean_classes">2.14. Using the @PostConstruct and @PreDestroy Annotations with CDI Managed Bean Classes</a></li>
<li><a href="#_further_information_about_cdi">2.15. Further Information about CDI</a></li>
</ul>
</li>
<li><a href="#_running_the_basic_contexts_and_dependency_injection_examples">3. Running the Basic Contexts and Dependency Injection Examples</a>
<ul class="sectlevel2">
<li><a href="#_building_and_running_the_cdi_samples">3.1. Building and Running the CDI Samples</a></li>
<li><a href="#_the_simplegreeting_cdi_example">3.2. The simplegreeting CDI Example</a></li>
<li><a href="#_the_guessnumber_cdi_cdi_example">3.3. The guessnumber-cdi CDI Example</a></li>
</ul>
</li>
<li><a href="#_jakarta_contexts_and_dependency_injection_advanced_topics">4. Jakarta Contexts and Dependency Injection: Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#_packaging_cdi_applications">4.1. Packaging CDI Applications</a></li>
<li><a href="#_using_alternatives_in_cdi_applications">4.2. Using Alternatives in CDI Applications</a></li>
<li><a href="#_using_producer_methods_producer_fields_and_disposer_methods_in_cdi_applications">4.3. Using Producer Methods, Producer Fields, and Disposer Methods in CDI Applications</a></li>
<li><a href="#_using_predefined_beans_in_cdi_applications">4.4. Using Predefined Beans in CDI Applications</a></li>
<li><a href="#_using_events_in_cdi_applications">4.5. Using Events in CDI Applications</a></li>
<li><a href="#_using_interceptors_in_cdi_applications">4.6. Using Interceptors in CDI Applications</a></li>
<li><a href="#_using_decorators_in_cdi_applications">4.7. Using Decorators in CDI Applications</a></li>
<li><a href="#_using_stereotypes_in_cdi_applications">4.8. Using Stereotypes in CDI Applications</a></li>
<li><a href="#using-the-built-in-annotation-literals">4.9. Using the Built-In Annotation Literals</a></li>
<li><a href="#using-the-configurators-interfaces">4.10. Using the Configurators Interfaces</a></li>
</ul>
</li>
<li><a href="#bootstrapping-a-cdi-container-in-java-se">5. Bootstrapping a CDI Container in Java SE</a>
<ul class="sectlevel2">
<li><a href="#the-bootstrap-api">5.1. The Bootstrap API</a></li>
</ul>
</li>
<li><a href="#_running_the_advanced_contexts_and_dependency_injection_examples">6. Running the Advanced Contexts and Dependency Injection Examples</a>
<ul class="sectlevel2">
<li><a href="#_building_and_running_the_cdi_advanced_examples">6.1. Building and Running the CDI Advanced Examples</a></li>
<li><a href="#_the_encoder_example_using_alternatives">6.2. The encoder Example: Using Alternatives</a></li>
<li><a href="#_the_producermethods_example_using_a_producer_method_to_choose_a_bean_implementation">6.3. The producermethods Example: Using a Producer Method to Choose a Bean Implementation</a></li>
<li><a href="#_the_producerfields_example_using_producer_fields_to_generate_resources">6.4. The producerfields Example: Using Producer Fields to Generate Resources</a></li>
<li><a href="#_the_billpayment_example_using_events_and_interceptors">6.5. The billpayment Example: Using Events and Interceptors</a></li>
<li><a href="#_the_decorators_example_decorating_a_bean">6.6. The decorators Example: Decorating a Bean</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_injection">1. Injection</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GKJIQ3"></a><a id="injection"></a></p>
</div>
<div class="paragraph">
<p>This chapter provides an overview of injection in Jakarta EE and describes
the two injection mechanisms provided by the platform: resource
injection and dependency injection.</p>
</div>
<div class="paragraph">
<p>Jakarta EE provides injection mechanisms that enable your objects to obtain
references to resources and other dependencies without having to
instantiate them directly. You declare the required resources and other
dependencies in your classes by decorating fields or methods with one of
the annotations that mark the field as an injection point. The container
then provides the required instances at runtime. Injection simplifies
your code and decouples it from the implementations of its dependencies.</p>
</div>
<div class="paragraph">
<p><a id="BABHDCAI"></a><a id="resource-injection"></a></p>
</div>
<div class="sect2">
<h3 id="_resource_injection">1.1. Resource Injection</h3>
<div class="paragraph">
<p>Resource injection enables you to inject any resource available in the
JNDI namespace into any container-managed object, such as a servlet, an
enterprise bean, or a managed bean. For example, you can use resource
injection to inject data sources, connectors, or custom resources
available in the JNDI namespace.</p>
</div>
<div class="paragraph">
<p>The type you use for the reference to the injected instance is usually
an interface, which decouples your code from the implementation of the
resource.</p>
</div>
<div class="paragraph">
<p>For example, the following code injects a data source object that
provides connections to the default Apache Derby database shipped with
GlassFish Server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="annotation">@Resource</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">java:comp/DefaultDataSource</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> javax.sql.DataSource dsc;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to field-based injection as in the preceding example, you
can inject resources using method-based injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="directive">private</span> javax.sql.DataSource dsc;
    ...
    <span class="annotation">@Resource</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">java:comp/DefaultDataSource</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> setDsc(java.sql.DataSource ds) {
        dsc = ds;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use method-based injection, the setter method must follow the
JavaBeans conventions for property names: The method name must begin
with <code>set</code>, have a <code>void</code> return type, and have only one parameter.</p>
</div>
<div class="paragraph">
<p>The <code>@Resource</code> annotation is in the <code>javax.annotation</code> package and is
defined in the Jakarta Annotations spec. Resource
injection resolves by name, so it is not typesafe: the type of the
resource object is not known at compile time, so you can get runtime
errors if the types of the object and its reference do not match.</p>
</div>
<div class="paragraph">
<p><a id="BABDJGIE"></a><a id="dependency-injection"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_dependency_injection">1.2. Dependency Injection</h3>
<div class="paragraph">
<p>Dependency injection enables you to turn regular Java classes into
managed objects and to inject them into any other managed object. Using
dependency injection, your code can declare dependencies on any managed
object. The container automatically provides instances of these
dependencies at the injection points at runtime, and it also manages the
lifecycle of these instances for you.</p>
</div>
<div class="paragraph">
<p>Dependency injection in Jakarta EE defines scopes, which determine the
lifecycle of the objects that the container instantiates and injects.
For example, a managed object that is only needed to respond to a single
client request (such as a currency converter) has a different scope than
a managed object that is needed to process multiple client requests
within a session (such as a shopping cart).</p>
</div>
<div class="paragraph">
<p>You can define managed objects (also called managed beans) that you can
later inject by assigning a scope to a regular class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.enterprise.context.RequestScoped
<span class="directive">public</span> <span class="type">class</span> <span class="class">CurrencyConverter</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <code>javax.inject.Inject</code> annotation to inject managed beans; for
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="annotation">@Inject</span> CurrencyConverter cc;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As opposed to resource injection, dependency injection is typesafe
because it resolves by type. To decouple your code from the
implementation of the managed bean, you can reference the injected
instances using an interface type and have your managed bean implement
that interface.</p>
</div>
<div class="paragraph">
<p>For more information about dependency injection, see
<a href="#GIWHB">Chapter 25, "Introduction to Jakarta Contexts and
Dependency Injection"</a> and the Jakarta Contexts and Dependency
Injection spec.</p>
</div>
<div class="paragraph">
<p><a id="BABHFECJ"></a><a id="the-main-differences-between-resource-injection-and-dependency-injection"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_the_main_differences_between_resource_injection_and_dependency_injection">1.3. The Main Differences between Resource Injection and Dependency Injection</h3>
<div class="paragraph">
<p><a href="#BABCEJEE">Table 4-1</a> lists the main differences between resource
injection and dependency injection.</p>
</div>
<div class="paragraph">
<p><a id="sthref19"></a><a id="BABCEJEE"></a></p>
</div>
<div class="paragraph">
<p><strong>Table 4-1 Differences between Resource Injection and Dependency
Injection</strong></p>
</div>
<table class="tableblock frame-all grid-all" style="width: 99%;">
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 15%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Injection Mechanism</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Can Inject JNDI Resources Directly</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Can Inject
Regular Classes Directly</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Resolves By</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Typesafe</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Injection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency Injection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_jakarta_contexts_and_dependency_injection">2. Introduction to Jakarta Contexts and Dependency Injection</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GIWHB"></a><a id="introduction-to-contexts-and-dependency-injection-for-jakarta-ee"></a></p>
</div>
<div class="paragraph">
<p>This chapter describes Jakarta Contexts and Dependency Injection
(CDI) which is one of several Jakarta EE features that help to knit
together the web tier and the transactional tier of the Jakarta EE
platform.</p>
</div>
<div class="paragraph">
<p><a id="BABJDJGA"></a><a id="getting-started"></a></p>
</div>
<div class="sect2">
<h3 id="_getting_started">2.1. Getting Started</h3>
<div class="paragraph">
<p>Contexts and Dependency Injection (CDI) enables your objects to have
their dependencies provided to them automatically, instead of creating
them or receiving them as parameters. CDI also manages the lifecycle of
those dependencies for you.</p>
</div>
<div class="paragraph">
<p>For example, consider the following servlet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@WebServlet</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/cdiservlet</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">NewServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="directive">private</span> Message message;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        message = <span class="keyword">new</span> MessageB();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> doGet(HttpServletRequest request, HttpServletResponse response)
                  <span class="directive">throws</span> <span class="exception">IOException</span> {
        response.getWriter().write(message.get());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This servlet needs an instance of an object that implements the
<code>Message</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Message</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The servlet creates itself an instance of the following object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MessageB</span> <span class="directive">implements</span> Message {
    <span class="directive">public</span> MessageB() { }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">message B</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using CDI, this servlet can declare its dependency on a <code>Message</code>
instance and have it injected automatically by the CDI runtime. The new
servlet code is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@WebServlet</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/cdiservlet</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">NewServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="annotation">@Inject</span> <span class="directive">private</span> Message message;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> doGet(HttpServletRequest request, HttpServletResponse response)
                  <span class="directive">throws</span> <span class="exception">IOException</span> {
        response.getWriter().write(message.get());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CDI runtime looks for classes that implement the <code>Message</code>
interface, finds the <code>MessageB</code> class, creates a new instance of it, and
injects it into the servlet at runtime. To manage the lifecycle of the
new instance, the CDI runtime needs to know what the scope of the
instance should be. In this example, the servlet only needs the instance
to process an HTTP request; the instance can then be garbage collected.
This is specified using the <code>javax.enterprise.context.RequestScoped</code>
annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MessageB</span> <span class="directive">implements</span> Message { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on scopes, see <a href="#GJBBK">Using
Scopes</a>.</p>
</div>
<div class="paragraph">
<p>The <code>MessageB</code> class is a CDI bean. CDI beans are classes that CDI can
instantiate, manage, and inject automatically to satisfy the
dependencies of other objects. Almost any Java class can be managed and
injected by CDI. For more information on beans, see
<a href="#GJEBJ">About Beans</a>. A JAR or WAR file that
contains a CDI bean is a bean archive. For more information on packaging
bean archives, see <a href="#GJBNZ">Configuring a CDI
Application</a> in this chapter and <a href="#CACDCFDE">Packaging
CDI Applications</a> in <a href="#GJEHI">Chapter 27, "Contexts and
Dependency Injection for Jakarta EE: Advanced Topics"</a>.</p>
</div>
<div class="paragraph">
<p>In this example, <code>MessageB</code> is the only class that implements the
<code>Message</code> interface. If an application has more than one implementation
of an interface, CDI provides mechanisms that you can use to select
which implementation to inject. For more information, see
<a href="#GJBCK">Using Qualifiers</a> in this chapter and
<a href="#GJSDF">Using Alternatives in CDI Applications</a> in
<a href="#GJEHI">Chapter 27, "Contexts and Dependency Injection
for Jakarta EE: Advanced Topics"</a>.</p>
</div>
<div class="paragraph">
<p><a id="GIWHL"></a><a id="overview-of-cdi"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_overview_of_cdi">2.2. Overview of CDI</h3>
<div class="paragraph">
<p>CDI is a set of services that, used together, make it easy for
developers to use enterprise beans along with Jakarta Server Faces
technology in web applications. Designed for use with stateful objects,
CDI also has many broader uses, allowing developers a great deal of
flexibility to integrate various kinds of components in a loosely
coupled but typesafe way</p>
</div>
<div class="paragraph">
<p>CDI 2.0 is specified in a Jakarta EE specification. Related specifications that CDI uses
include the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jakarta Dependency Injection</p>
</li>
<li>
<p>The Managed Beans specification, an offshoot of the Jakarta EE platform
specification</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The most fundamental services provided by CDI are as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Contexts: This service enables you to bind the lifecycle and
interactions of stateful components to well-defined but extensible
lifecycle contexts.</p>
</li>
<li>
<p>Dependency injection: This service enables you to inject components
into an application in a typesafe way and to choose at deployment time
which implementation of a particular interface to inject.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, CDI provides the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integration with the Expression Language (EL), which allows any
component to be used directly within a Jakarta Server Faces page or a
Jakarta Server Pages page</p>
</li>
<li>
<p>The ability to decorate injected components</p>
</li>
<li>
<p>The ability to associate interceptors with components using typesafe
interceptor bindings</p>
</li>
<li>
<p>An event-notification model</p>
</li>
<li>
<p>A web conversation scope in addition to the three standard scopes
(request, session, and application) defined by the Jakarta Servlet
specification</p>
</li>
<li>
<p>A complete Service Provider Interface (SPI) that allows third-party
frameworks to integrate cleanly in the Jakarta EE environment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A major theme of CDI is loose coupling. CDI does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Decouples the server and the client by means of well-defined types and
qualifiers, so that the server implementation may vary</p>
</li>
<li>
<p>Decouples the lifecycles of collaborating components by</p>
<div class="ulist">
<ul>
<li>
<p>Making components contextual, with automatic lifecycle management</p>
</li>
<li>
<p>Allowing stateful components to interact like services, purely by
message passing</p>
</li>
</ul>
</div>
</li>
<li>
<p>Completely decouples message producers from consumers, by means of
events</p>
</li>
<li>
<p>Decouples orthogonal concerns by means of Jakarta EE interceptors</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Along with loose coupling, CDI provides strong typing by</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eliminating lookup using string-based names for wiring and
correlations so that the compiler will detect typing errors</p>
</li>
<li>
<p>Allowing the use of declarative Java annotations to specify
everything, largely eliminating the need for XML deployment descriptors,
and making it easy to provide tools that introspect the code and
understand the dependency structure at development time</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GJEBJ"></a><a id="about-beans"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_about_beans">2.3. About Beans</h3>
<div class="paragraph">
<p>CDI redefines the concept of a bean beyond its use in other Java
technologies, such as the JavaBeans and Jakarta Enterprise Beans
technologies. In CDI, a bean is a source of contextual objects that
define application state or logic. A Jakarta EE component is a bean if
the lifecycle of its instances may be managed by the container according
to the lifecycle context model defined in the CDI specification.</p>
</div>
<div class="paragraph">
<p>More specifically, a bean has the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A (nonempty) set of bean types</p>
</li>
<li>
<p>A (nonempty) set of qualifiers (see <a href="#GJBCK">Using
Qualifiers</a>)</p>
</li>
<li>
<p>A scope (see <a href="#GJBBK">Using Scopes</a>)</p>
</li>
<li>
<p>Optionally, a bean EL name (see <a href="#GJBAK">Giving
Beans EL Names</a>)</p>
</li>
<li>
<p>A set of interceptor bindings</p>
</li>
<li>
<p>A bean implementation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A bean type defines a client-visible type of the bean. Almost any Java
type may be a bean type of a bean.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A bean type may be an interface, a concrete class, or an abstract
class and may be declared final or have final methods.</p>
</li>
<li>
<p>A bean type may be a parameterized type with type parameters and type
variables.</p>
</li>
<li>
<p>A bean type may be an array type. Two array types are considered
identical only if the element type is identical.</p>
</li>
<li>
<p>A bean type may be a primitive type. Primitive types are considered to
be identical to their corresponding wrapper types in <code>java.lang</code>.</p>
</li>
<li>
<p>A bean type may be a raw type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GJFZI"></a><a id="about-cdi-managed-beans"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_about_cdi_managed_beans">2.4. About CDI Managed Beans</h3>
<div class="paragraph">
<p>A managed bean is implemented by a Java class, which is called its bean
class. A top-level Java class is a managed bean if it is defined to be a
managed bean by any other Jakarta EE technology specification, such as the
JavaServer Faces technology specification, or if it meets all the
following conditions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is not a nonstatic inner class.</p>
</li>
<li>
<p>It is a concrete class or is annotated <code>@Decorator</code>.</p>
</li>
<li>
<p>It is not annotated with an enterprise bean component-defining annotation or
declared as an enterprise bean class in <code>ejb-jar.xml</code>.</p>
</li>
<li>
<p>It has an appropriate constructor. That is, one of the following is
the case.</p>
<div class="ulist">
<ul>
<li>
<p>The class has a constructor with no parameters.</p>
</li>
<li>
<p>The class declares a constructor annotated <code>@Inject</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>No special declaration, such as an annotation, is required to define a
managed bean.</p>
</div>
<div class="paragraph">
<p><a id="GIZKS"></a><a id="beans-as-injectable-objects"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_beans_as_injectable_objects">2.5. Beans as Injectable Objects</h3>
<div class="paragraph">
<p>The concept of injection has been part of Java technology for some time.
Since the Java EE 5 platform was introduced, annotations have made it
possible to inject resources and some other kinds of objects into
container-managed objects. CDI makes it possible to inject more kinds of
objects and to inject them into objects that are not container-managed.</p>
</div>
<div class="paragraph">
<p>The following kinds of objects can be injected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Almost any Java class</p>
</li>
<li>
<p>Session beans</p>
</li>
<li>
<p>Jakarta EE resources: data sources, Java Message Service topics, queues,
connection factories, and the like</p>
</li>
<li>
<p>Persistence contexts (Jakarta Persistence <code>EntityManager</code> objects)</p>
</li>
<li>
<p>Producer fields</p>
</li>
<li>
<p>Objects returned by producer methods</p>
</li>
<li>
<p>Web service references</p>
</li>
<li>
<p>Remote enterprise bean references</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, suppose that you create a simple Java class with a method
that returns a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">greetings</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Greeting</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> greet(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class becomes a bean that you can then inject into another class.
This bean is not exposed to the EL in this form.
<a href="#GJBAK">Giving Beans EL Names</a> explains how you can
make a bean accessible to the EL.</p>
</div>
<div class="paragraph">
<p><a id="GJBCK"></a><a id="using-qualifiers"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_qualifiers">2.6. Using Qualifiers</h3>
<div class="paragraph">
<p>You can use qualifiers to provide various implementations of a
particular bean type. A qualifier is an annotation that you apply to a
bean. A qualifier type is a Java annotation defined as
<code>@Target({METHOD, FIELD, PARAMETER, TYPE})</code> and <code>@Retention(RUNTIME)</code>.</p>
</div>
<div class="paragraph">
<p>For example, you could declare an <code>@Informal</code> qualifier type and apply
it to another class that extends the <code>Greeting</code> class. To declare this
qualifier type, use the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">greetings</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.FIELD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.METHOD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.PARAMETER</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.TYPE</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.RetentionPolicy.RUNTIME</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.RetentionPolicy.RUNTIME</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;

<span class="keyword">import</span> <span class="include">jakarta.inject.Qualifier</span>;

<span class="annotation">@Qualifier</span>
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>({TYPE, METHOD, FIELD, PARAMETER})
<span class="directive">public</span> <span class="annotation">@interface</span> Informal {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then define a bean class that extends the <code>Greeting</code> class and
uses this qualifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">greetings</span>;

<span class="annotation">@Informal</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">InformalGreeting</span> <span class="directive">extends</span> Greeting {
    <span class="directive">public</span> <span class="predefined-type">String</span> greet(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hi, </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content">!</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both implementations of the bean can now be used in the application.</p>
</div>
<div class="paragraph">
<p>If you define a bean with no qualifier, then the bean automatically has the
qualifier <code>@Default</code>. The unannotated <code>Greeting</code> class could be declared
as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">greetings</span>;

<span class="keyword">import</span> <span class="include">jakarta.enterprise.inject.Default</span>;

<span class="annotation">@Default</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Greeting</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> greet(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJBAN"></a><a id="injecting-beans"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_injecting_beans">2.7. Injecting Beans</h3>
<div class="paragraph">
<p>To use the beans you create, you inject them into yet another
bean that can then be used by an application, such as a Jakarta Server Faces
application. For example, you might create a bean called <code>Printer</code> into
which you would inject one of the <code>Greeting</code> beans:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Printer</span> {

    <span class="annotation">@Inject</span> Greeting greeting;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code injects the <code>@Default</code> <code>Greeting</code> implementation into the
bean. The following code injects the <code>@Informal</code> implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Printer</span> {

    <span class="annotation">@Inject</span> <span class="annotation">@Informal</span> Greeting greeting;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>More is needed for the complete picture of this bean. Its use of scope
needs to be understood. In addition, for a Jakarta Server Faces application,
the bean needs to be accessible through the EL.</p>
</div>
<div class="paragraph">
<p>Now that you can identify the target of the injection, it is important to
understand what can be injected and in what context. Faces 2.3 provides producers
that enable most important Faces artifacts to be injected. For detailed information,
see the package <a href="https://jakarta.ee/specifications/faces/2.3/apidocs/">javadoc</a> for
<code>javax.faces.annotation</code>.</p>
</div>
<div class="paragraph">
<p><a id="GJBBK"></a><a id="using-scopes"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_scopes">2.8. Using Scopes</h3>
<div class="paragraph">
<p>For a web application to use a bean that injects another bean class, the
bean needs to be able to hold state over the duration of the user&#8217;s
interaction with the application. The way to define this state is to
give the bean a scope. You can give an object any of the scopes
described in <a href="#GJDBG">Table 25-1</a>, depending on how you are using it.</p>
</div>
<div class="paragraph">
<p><a id="sthref126"></a><a id="GJDBG"></a></p>
</div>
<div class="paragraph">
<p>Table 25-1 Scopes</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 99%;">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Scope</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Annotation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Duration</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user&#8217;s interaction with a web application
in a single HTTP request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@SessionScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user&#8217;s interaction with a web application
across multiple HTTP requests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ApplicationScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shared state across all users'
interactions with a web application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Dependent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default scope if none is specified; it
means that an object exists to serve exactly one client (bean) and has
the same lifecycle as that client (bean).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conversation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ConversationScoped</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user&#8217;s interaction with a
servlet, including Jakarta Server Faces applications. The conversation scope
exists within developer-controlled boundaries that extend it across
multiple requests for long-running conversations. All long-running
conversations are scoped to a particular HTTP servlet session and may
not cross session boundaries.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first three scopes are defined by both JSR 365 and the Jakarta Server
Faces specification. The last two are defined by JSR 365.</p>
</div>
<div class="paragraph">
<p>All predefined scopes except <code>@Dependent</code> are contextual scopes. CDI
places beans of contextual scope in the context whose lifecycle is
defined by the Jakarta EE specifications. For example, a session context
and its beans exist during the lifetime of an HTTP session. Injected
references to the beans are contextually aware. The references always
apply to the bean that is associated with the context for the thread
that is making the reference. The CDI container ensures that the objects
are created and injected at the correct time as determined by the scope
that is specified for these objects.</p>
</div>
<div class="paragraph">
<p>You can also define and implement custom scopes, but that is an advanced
topic. Custom scopes are likely to be used by those who implement and
extend the CDI specification.</p>
</div>
<div class="paragraph">
<p>A scope gives an object a well-defined lifecycle context. A scoped
object can be automatically created when it is needed and automatically
destroyed when the context in which it was created ends. Moreover, its
state is automatically shared by any clients that execute in the same
context.</p>
</div>
<div class="paragraph">
<p>Jakarta EE components, such as servlets and enterprise beans, and JavaBeans
components do not by definition have a well-defined scope. These
components are one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Singletons, such as enterprise singleton beans, whose state
is shared among all clients</p>
</li>
<li>
<p>Stateless objects, such as servlets and stateless session beans, which
do not contain client-visible state</p>
</li>
<li>
<p>Objects that must be explicitly created and destroyed by their client,
such as JavaBeans components and stateful session beans, whose state is
shared by explicit reference passing between clients</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, if you create a Jakarta EE component that is a managed bean, then it
becomes a scoped object, which exists in a well-defined lifecycle
context.</p>
</div>
<div class="paragraph">
<p>The web application for the <code>Printer</code> bean will use a simple request and
response mechanism, so the managed bean can be annotated as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.RequestScoped</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;

<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Printer</span> {

    <span class="annotation">@Inject</span> <span class="annotation">@Informal</span> Greeting greeting;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beans that use session, application, or conversation scope must be
serializable, but beans that use request scope do not have to be
serializable.</p>
</div>
<div class="paragraph">
<p><a id="GJBAK"></a><a id="giving-beans-el-names"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_giving_beans_el_names">2.9. Giving Beans EL Names</h3>
<div class="paragraph">
<p>To make a bean accessible through the EL, use the <code>@Named</code> built-in qualifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.RequestScoped</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Named</span>;

<span class="annotation">@Named</span>
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Printer</span> {

    <span class="annotation">@Inject</span> <span class="annotation">@Informal</span> Greeting greeting;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Named</code> qualifier allows you to access the bean by using the bean
name, with the first letter in lowercase. For example, a Facelets page
would refer to the bean as <code>printer</code>.</p>
</div>
<div class="paragraph">
<p>You can specify an argument to the <code>@Named</code> qualifier to use a
nondefault name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">MyPrinter</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this annotation, the Facelets page would refer to the bean as
<code>MyPrinter</code>.</p>
</div>
<div class="paragraph">
<p><a id="GJBBP"></a><a id="adding-setter-and-getter-methods"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_adding_setter_and_getter_methods">2.10. Adding Setter and Getter Methods</h3>
<div class="paragraph">
<p>To make the state of the managed bean accessible, add setter and getter methods for that state. The <code>createSalutation</code> method calls the bean&#8217;s <code>greet</code> method, and the
<code>getSalutation</code> method retrieves the result.</p>
</div>
<div class="paragraph">
<p>Once the setter and getter methods have been added, the bean is
complete. The final code looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">greetings</span>;

<span class="keyword">import</span> <span class="include">jakarta.enterprise.context.RequestScoped</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Named</span>;

<span class="annotation">@Named</span>
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Printer</span> {

    <span class="annotation">@Inject</span> <span class="annotation">@Informal</span> Greeting greeting;

    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> <span class="predefined-type">String</span> salutation;

    <span class="directive">public</span> <span class="type">void</span> createSalutation() {
        <span class="local-variable">this</span>.salutation = greeting.greet(name);
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getSalutation() {
        <span class="keyword">return</span> salutation;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJBBU"></a><a id="using-a-managed-bean-in-a-facelets-page"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_a_managed_bean_in_a_facelets_page">2.11. Using a Managed Bean in a Facelets Page</h3>
<div class="paragraph">
<p>To use the managed bean in a Facelets page, create a form that uses user interface elements to call its methods and to display their results. The following example provides a button that asks the user to type a name, retrieves the salutation, and then displays the text in a paragraph below the button:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">greetme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter your name: </span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.name}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
   <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Say Hello</span><span class="delimiter">&quot;</span></span>
                       <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.createSalutation}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
   <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.salutation}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/h:form&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJDID"></a><a id="injecting-objects-by-using-producer-methods"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_injecting_objects_by_using_producer_methods">2.12. Injecting Objects by Using Producer Methods</h3>
<div class="paragraph">
<p>Producer methods provide a way to inject objects that are not beans,
objects whose values may vary at runtime, and objects that require
custom initialization. For example, if you want to initialize a numeric
value defined by a qualifier named <code>@MaxNumber</code>, then you can define the
value in a managed bean and then define a producer method,
<code>getMaxNumber</code>, for it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">int</span> maxNumber = <span class="integer">100</span>;
...
<span class="annotation">@Produces</span> <span class="annotation">@MaxNumber</span> <span class="type">int</span> getMaxNumber() {
    <span class="keyword">return</span> maxNumber;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you inject the object in another managed bean, the container
automatically invokes the producer method, initializing the value to
100:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> <span class="annotation">@MaxNumber</span> <span class="directive">private</span> <span class="type">int</span> maxNumber;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the value can vary at runtime, then the process is slightly different. For
example, the following code defines a producer method that generates a
random number defined by a qualifier called <code>@Random</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> java.util.Random random =
    <span class="keyword">new</span> java.util.Random( <span class="predefined-type">System</span>.currentTimeMillis() );

java.util.Random getRandom() {
        <span class="keyword">return</span> random;
}

<span class="annotation">@Produces</span> <span class="annotation">@Random</span> <span class="type">int</span> next() {
    <span class="keyword">return</span> getRandom().nextInt(maxNumber);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you inject this object in another managed bean, you declare a
contextual instance of the object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> <span class="annotation">@Random</span> Instance&lt;<span class="predefined-type">Integer</span>&gt; randomInt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You then call the <code>get</code> method of the <code>Instance</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="local-variable">this</span>.number = randomInt.get();</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJBNZ"></a><a id="configuring-a-cdi-application"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_a_cdi_application">2.13. Configuring a CDI Application</h3>
<div class="paragraph">
<p>When your beans are annotated with a scope type, the server recognizes
the application as a bean archive and no additional configuration is
required. The possible scope types for CDI beans are listed in
<a href="#GJBBK">Using Scopes</a>.</p>
</div>
<div class="paragraph">
<p>CDI uses an optional deployment descriptor named <code>beans.xml</code>. Like other
Jakarta EE deployment descriptors, the configuration settings in
<code>beans.xml</code> are used in addition to annotation settings in CDI classes.
The settings in <code>beans.xml</code> override the annotation settings if there is
a conflict. An archive must contain the <code>beans.xml</code> deployment
descriptor only in certain limited situations, described in
<a href="#GJEHI">Chapter 27, "Jakarta Contexts and Dependency Injection: Advanced Topics"</a>.</p>
</div>
<div class="paragraph">
<p>For a web application, the <code>beans.xml</code> deployment descriptor, if
present, must be in the <code>WEB-INF</code> directory. For EJB modules or JAR
files, the <code>beans.xml</code> deployment descriptor, if present, must be in the
<code>META-INF</code> directory.</p>
</div>
<div class="paragraph">
<p><a id="BABJFEAI"></a><a id="using-the-postconstruct-and-predestroy-annotations-with-cdi-managed-bean-classes"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_postconstruct_and_predestroy_annotations_with_cdi_managed_bean_classes">2.14. Using the @PostConstruct and @PreDestroy Annotations with CDI Managed Bean Classes</h3>
<div class="paragraph">
<p>CDI managed bean classes and their superclasses support the annotations
for initializing and for preparing for the destruction of a bean. These
annotations are defined in Jakarta Annotations (<code><a href="https://jakarta.ee/specifications/annotations/1.3/" class="bare">https://jakarta.ee/specifications/annotations/1.3/</a></code>).</p>
</div>
<div class="paragraph">
<p><a id="CIHEHHCH"></a><a id="to-initialize-a-managed-bean-using-the-postconstruct-annotation"></a></p>
</div>
<div class="sect3">
<h4 id="_to_initialize_a_managed_bean_using_the_postconstruct_annotation">2.14.1. To Initialize a Managed Bean Using the @PostConstruct Annotation</h4>
<div class="paragraph">
<p>Initializing a managed bean specifies the lifecycle callback method that
the CDI framework should call after dependency injection but before the
class is put into service.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the managed bean class or any of its superclasses, define a
method that performs the initialization that you require.</p>
</li>
<li>
<p>Annotate the declaration of the method with the
<code>javax.annotation.PostConstruct</code> annotation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When the managed bean is injected into a component, CDI calls the method
after all injection has occurred and after all initializers have been
called.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Note:</p>
</div>
<div class="paragraph">
<p>As mandated in JSR 250, if the annotated method is declared in a
superclass, the method is called unless a subclass of the declaring
class overrides the method.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>UserNumberBean</code> managed bean in
<a href="#GJCXV">The guessnumber-cdi CDI Example</a>
uses <code>@PostConstruct</code> to annotate a method that resets all bean fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PostConstruct</span>
<span class="directive">public</span> <span class="type">void</span> reset () {
    <span class="local-variable">this</span>.minimum = <span class="integer">0</span>;
    <span class="local-variable">this</span>.userNumber = <span class="integer">0</span>;
    <span class="local-variable">this</span>.remainingGuesses = <span class="integer">0</span>;
    <span class="local-variable">this</span>.maximum = maxNumber;
    <span class="local-variable">this</span>.number = randomInt.get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="CIHBAFAC"></a><a id="to-prepare-for-the-destruction-of-a-managed-bean-using-the-predestroy-annotation"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_to_prepare_for_the_destruction_of_a_managed_bean_using_the_predestroy_annotation">2.14.2. To Prepare for the Destruction of a Managed Bean Using the @PreDestroy Annotation</h4>
<div class="paragraph">
<p>Preparing for the destruction of a managed bean specifies the lifecycle
call back method that signals that an application component is about to
be destroyed by the container.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the managed bean class or any of its superclasses, prepare for
the destruction of the managed bean.</p>
<div class="paragraph">
<p>In this method, perform any cleanup that is required before the bean is
destroyed, such as releasing a resource that the bean has been holding.</p>
</div>
</li>
<li>
<p>Annotate the declaration of the method with the
<code>javax.annotation.PreDestroy</code> annotation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>CDI calls this method before starting to destroy the bean.</p>
</div>
<div class="paragraph">
<p><a id="GIWEL"></a><a id="further-information-about-cdi"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_further_information_about_cdi">2.15. Further Information about CDI</h3>
<div class="paragraph">
<p>For more information about CDI, see</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Contexts and Dependency Injection for Jakarta EE specification:</p>
<div class="paragraph">
<p><code><a href="https://jakarta.ee/specifications/cdi/2.0/" class="bare">https://jakarta.ee/specifications/cdi/2.0/</a></code></p>
</div>
</li>
<li>
<p>An introduction to Contexts and Dependency Injection for Jakarta EE:</p>
<div class="paragraph">
<p><code><a href="http://docs.jboss.org/weld/reference/latest/en-US/html/" class="bare">http://docs.jboss.org/weld/reference/latest/en-US/html/</a></code></p>
</div>
</li>
<li>
<p>Jakarta Dependency Injection specification:</p>
<div class="paragraph">
<p><code><a href="https://jakarta.ee/specifications/dependency-injection/1.0/" class="bare">https://jakarta.ee/specifications/dependency-injection/1.0/</a></code></p>
</div>
</li>
<li>
<p>Jakarta Managed beans specification, which is part of the Jakarta EE Platform Specification:</p>
<div class="paragraph">
<p><code><a href="https://jakarta.ee/specifications/managedbeans/1.0/" class="bare">https://jakarta.ee/specifications/managedbeans/1.0/</a></code></p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_basic_contexts_and_dependency_injection_examples">3. Running the Basic Contexts and Dependency Injection Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GJBLS"></a><a id="running-the-basic-contexts-and-dependency-injection-examples"></a></p>
</div>
<div class="paragraph">
<p>This chapter describes in detail how to build and run simple examples
that use CDI.</p>
</div>
<div class="paragraph">
<p><a id="A1250045"></a><a id="building-and-running-the-cdi-samples"></a></p>
</div>
<div class="sect2">
<h3 id="_building_and_running_the_cdi_samples">3.1. Building and Running the CDI Samples</h3>
<div class="paragraph">
<p>The examples are in the <code><em>tut-install</em>/examples/cdi/</code> directory.</p>
</div>
<div class="paragraph">
<p>To build and run the examples, you will do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use NetBeans IDE or the Maven tool to compile and package the
example.</p>
</li>
<li>
<p>Use NetBeans IDE or the Maven tool to deploy the example.</p>
</li>
<li>
<p>Run the example in a web browser.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See <a href="#GFIUD">Chapter 2, "Using the Tutorial
Examples"</a>, for basic information on installing, building, and running
the examples.</p>
</div>
<div class="paragraph">
<p><a id="GJBJU"></a><a id="the-simplegreeting-cdi-example"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_the_simplegreeting_cdi_example">3.2. The simplegreeting CDI Example</h3>
<div class="paragraph">
<p>The <code>simplegreeting</code> example illustrates some of the most basic features
of CDI: scopes, qualifiers, bean injection, and accessing a managed bean
in a Jakarta Server Faces application. When you run the example, you click a
button that presents either a formal or an informal greeting, depending
on how you edited one of the classes. The example includes four source
files, a Facelets page and template, and configuration files.</p>
</div>
<div class="paragraph">
<p><a id="GJCQS"></a><a id="the-simplegreeting-source-files"></a></p>
</div>
<div class="sect3">
<h4 id="_the_simplegreeting_source_files">3.2.1. The simplegreeting Source Files</h4>
<div class="paragraph">
<p>The four source files for the <code>simplegreeting</code> example are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default <code>Greeting</code> class, shown in
<a href="#GIZKS">Beans as Injectable Objects</a></p>
</li>
<li>
<p>The <code>@Informal</code> qualifier interface definition and the
<code>InformalGreeting</code> class that implements the interface, both shown in
<a href="#GJBCK">Using Qualifiers</a></p>
</li>
<li>
<p>The <code>Printer</code> managed bean class, which injects one of the two
interfaces, shown in full in <a href="#GJBBP">Adding Setter
and Getter Methods</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/simplegreeting/src/main/java/ee/jakarta/tutorial/simplegreeting</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="GJDOJ"></a><a id="the-facelets-template-and-page"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_facelets_template_and_page">3.2.2. The Facelets Template and Page</h4>
<div class="paragraph">
<p>To use the managed bean in a simple Facelets application:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use a very simple template file and <code>index.xhtml</code> page.</p>
<div class="paragraph">
<p>The template page, <code>template.xhtml</code>, looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
          &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/html</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/facelets</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;h:head&gt;</span>
        <span class="tag">&lt;meta</span> <span class="attribute-name">http-equiv</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html; charset=UTF-8</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;h:outputStylesheet</span> <span class="attribute-name">library</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">css</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default.css</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;title&gt;</span><span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Default Title<span class="tag">&lt;/ui:insert&gt;</span><span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;/h:head&gt;</span>

    <span class="tag">&lt;body&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">container</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;h2&gt;</span><span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">head</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Head<span class="tag">&lt;/ui:insert&gt;</span><span class="tag">&lt;/h2&gt;</span>
            <span class="tag">&lt;/div&gt;</span>

            <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">space</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;p&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;/div&gt;</span>

            <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>To create the Facelets page, redefine the title and head, then add a
small form to the content:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
          &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/facelets</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;ui:composition</span> <span class="attribute-name">template</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/template.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Simple Greeting<span class="tag">&lt;/ui:define&gt;</span>
        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">head</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Simple Greeting<span class="tag">&lt;/ui:define&gt;</span>
        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">greetme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
               <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter your name: </span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                  <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.name}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
               <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Say Hello</span><span class="delimiter">&quot;</span></span>
                                   <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.createSalutation}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
               <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{printer.salutation}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;/h:form&gt;</span>
        <span class="tag">&lt;/ui:define&gt;</span>

    <span class="tag">&lt;/ui:composition&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The form asks the user to enter a name. The button is labeled <strong>Say Hello</strong>,
and the action defined for it is to call the <code>createSalutation</code> method
of the <code>Printer</code> managed bean. This method in turn calls the <code>greet</code>
method of the defined <code>Greeting</code> class.</p>
</div>
<div class="paragraph">
<p>The output text for the form is the value of the greeting returned by
the setter method. Depending on whether the default or the <code>@Informal</code>
version of the greeting is injected, this is one of the following, where
<code>name</code> is the name entered by the user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Hello, name.

Hi, name!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Facelets page and template are located in the
<code><em>tut-install</em>/examples/cdi/simplegreeting/src/main/webapp/</code> directory.</p>
</div>
<div class="paragraph">
<p>The simple CSS file that is used by the Facelets page is in the
following location:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/simplegreeting/src/main/webapp/resources/css/<span class="keyword">default</span>.css</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJCYM"></a><a id="running-the-simplegreeting-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_simplegreeting_example">3.2.3. Running the simplegreeting Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>simplegreeting</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GJCXP"></a><a id="to-build-package-and-run-the-simplegreeting-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_run_the_simplegreeting_example_using_netbeans_ide">To Build, Package, and Run the simplegreeting Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the <strong>File</strong> menu, choose <strong>Open Project</strong>.</p>
</li>
<li>
<p>In the <strong>Open Project</strong> dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>simplegreeting</code> folder.</p>
</li>
<li>
<p>Click <strong>Open Project</strong>.</p>
</li>
<li>
<p>To modify the <code>Printer.java</code> file, perform these steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>Expand the <strong>Source Packages</strong> node.</p>
</li>
<li>
<p>Expand the <code>greetings</code> node.</p>
</li>
<li>
<p>Double-click the <code>Printer.java</code> file.</p>
</li>
<li>
<p>In the editor, comment out the <code>@Informal</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
<span class="comment">//@Informal</span>
Greeting greeting;</code></pre>
</div>
</div>
</li>
<li>
<p>Save the file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In the <strong>Projects</strong> tab, right-click the <code>simplegreeting</code> project and
select <strong>Build</strong>.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>simplegreeting.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJCZT"></a><a id="to-build-package-and-deploy-the-simplegreeting-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_simplegreeting_example_using_maven">To Build, Package, and Deploy the simplegreeting Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/simplegreeting/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>simplegreeting.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJCZE"></a><a id="to-run-the-simplegreeting-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_simplegreeting_example">To Run the simplegreeting Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/simplegreeting</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>Simple Greeting</strong> page opens.</p>
</div>
</li>
<li>
<p>Enter a name in the field.</p>
<div class="paragraph">
<p>For example, suppose that you enter <code>Duke</code>.</p>
</div>
</li>
<li>
<p>Click <strong>Say Hello</strong>.</p>
<div class="paragraph">
<p>If you did not modify the <code>Printer.java</code> file, then the following text string
appears below the button:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Hi, Duke!</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you commented out the <code>@Informal</code> annotation in the <code>Printer.java</code>
file, then the following text string appears below the button:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Hello, Duke.</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJCXV"></a><a id="the-guessnumber-cdi-cdi-example"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_guessnumber_cdi_cdi_example">3.3. The guessnumber-cdi CDI Example</h3>
<div class="paragraph">
<p>The <code>guessnumber-cdi</code> example, somewhat more complex than the
<code>simplegreeting</code> example, illustrates the use of producer methods and of
session and application scope. The example is a game in which you try to
guess a number in fewer than ten attempts. It is similar to the
<code>guessnumber-jsf</code> example described in
<a href="#GIEPX">Chapter 8, "Introduction to Facelets"</a>,
except that you can keep guessing until you get the right answer or
until you use up your ten attempts.</p>
</div>
<div class="paragraph">
<p>The example includes four source files, a Facelets page and template,
and configuration files. The configuration files and the template are
the same as those used for the <code>simplegreeting</code> example.</p>
</div>
<div class="paragraph">
<p><a id="GJDJU"></a><a id="the-guessnumber-cdi-source-files"></a></p>
</div>
<div class="sect3">
<h4 id="_the_guessnumber_cdi_source_files">3.3.1. The guessnumber-cdi Source Files</h4>
<div class="paragraph">
<p>The four source files for the <code>guessnumber-cdi</code> example are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>@MaxNumber</code> qualifier interface</p>
</li>
<li>
<p>The <code>@Random</code> qualifier interface</p>
</li>
<li>
<p>The <code>Generator</code> managed bean, which defines producer methods</p>
</li>
<li>
<p>The <code>UserNumberBean</code> managed bean</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/guessnumber-cdi/src/main/java/ee/jakarta/tutorial/guessnumber</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="GJDJP"></a><a id="the-maxnumber-and-random-qualifier-interfaces"></a></p>
</div>
<div class="sect4">
<h5 id="_the_maxnumber_and_random_qualifier_interfaces">The @MaxNumber and @Random Qualifier Interfaces</h5>
<div class="paragraph">
<p>The <code>@MaxNumber</code> qualifier interface is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">guessnumber</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.Documented</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.FIELD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.METHOD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.PARAMETER</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.TYPE</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.RetentionPolicy.RUNTIME</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Qualifier</span>;

<span class="annotation">@Target</span>({TYPE, METHOD, PARAMETER, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Documented</span>
<span class="annotation">@Qualifier</span>
<span class="directive">public</span> <span class="annotation">@interface</span> MaxNumber {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Random</code> qualifier interface is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">guessnumber</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.Documented</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.FIELD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.METHOD</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.PARAMETER</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.ElementType.TYPE</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.lang.annotation.RetentionPolicy.RUNTIME</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Qualifier</span>;

<span class="annotation">@Target</span>({TYPE, METHOD, PARAMETER, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Documented</span>
<span class="annotation">@Qualifier</span>
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Random</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJDJN"></a><a id="the-generator-managed-bean"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_the_generator_managed_bean">The Generator Managed Bean</h5>
<div class="paragraph">
<p>The <code>Generator</code> managed bean contains the two producer methods for the
application. The bean has the <code>@ApplicationScoped</code> annotation to specify
that its context extends for the duration of the user&#8217;s interaction with
the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">guessnumber</span>;

<span class="keyword">import</span> <span class="include">java.io.Serializable</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.inject.Produces</span>;

<span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Generator</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> serialVersionUID = -<span class="integer">7213673465118041882L</span>;

    <span class="directive">private</span> <span class="directive">final</span> java.util.Random random =
        <span class="keyword">new</span> java.util.Random( <span class="predefined-type">System</span>.currentTimeMillis() );

    <span class="directive">private</span> <span class="directive">final</span> <span class="type">int</span> maxNumber = <span class="integer">100</span>;

    java.util.Random getRandom() {
        <span class="keyword">return</span> random;
    }

    <span class="annotation">@Produces</span> <span class="annotation">@Random</span> <span class="type">int</span> next() {
        <span class="keyword">return</span> getRandom().nextInt(maxNumber + <span class="integer">1</span>);
    }

    <span class="annotation">@Produces</span> <span class="annotation">@MaxNumber</span> <span class="type">int</span> getMaxNumber() {
        <span class="keyword">return</span> maxNumber;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJDHY"></a><a id="the-usernumberbean-managed-bean"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_the_usernumberbean_managed_bean">The UserNumberBean Managed Bean</h5>
<div class="paragraph">
<p>The <code>UserNumberBean</code> managed bean, the managed bean for the Jakarta Server
Faces application, provides the basic logic for the game. This bean does
the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implements setter and getter methods for the bean fields</p>
</li>
<li>
<p>Injects the two qualifier objects</p>
</li>
<li>
<p>Provides a <code>reset</code> method that allows you to begin a new game after
you complete one</p>
</li>
<li>
<p>Provides a <code>check</code> method that determines whether the user has guessed
the number</p>
</li>
<li>
<p>Provides a <code>validateNumberRange</code> method that determines whether the
user&#8217;s input is correct</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The bean is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">guessnumber</span>;

<span class="keyword">import</span> <span class="include">java.io.Serializable</span>;
<span class="keyword">import</span> <span class="include">jakarta.annotation.PostConstruct</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.context.SessionScoped</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.inject.Instance</span>;
<span class="keyword">import</span> <span class="include">jakarta.faces.application.FacesMessage</span>;
<span class="keyword">import</span> <span class="include">jakarta.faces.component.UIComponent</span>;
<span class="keyword">import</span> <span class="include">jakarta.faces.component.UIInput</span>;
<span class="keyword">import</span> <span class="include">jakarta.faces.context.FacesContext</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Named</span>;

<span class="annotation">@Named</span>
<span class="annotation">@SessionScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">UserNumberBean</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> serialVersionUID = -<span class="integer">7698506329160109476L</span>;

    <span class="directive">private</span> <span class="type">int</span> number;
    <span class="directive">private</span> <span class="predefined-type">Integer</span> userNumber;
    <span class="directive">private</span> <span class="type">int</span> minimum;
    <span class="directive">private</span> <span class="type">int</span> remainingGuesses;

    <span class="annotation">@MaxNumber</span>
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> <span class="type">int</span> maxNumber;

    <span class="directive">private</span> <span class="type">int</span> maximum;

    <span class="annotation">@Random</span>
    <span class="annotation">@Inject</span>
    Instance&lt;<span class="predefined-type">Integer</span>&gt; randomInt;

    <span class="directive">public</span> UserNumberBean() {
    }

    <span class="directive">public</span> <span class="type">int</span> getNumber() {
        <span class="keyword">return</span> number;
    }

    <span class="directive">public</span> <span class="type">void</span> setUserNumber(<span class="predefined-type">Integer</span> user_number) {
        userNumber = user_number;
    }

    <span class="directive">public</span> <span class="predefined-type">Integer</span> getUserNumber() {
        <span class="keyword">return</span> userNumber;
    }

    <span class="directive">public</span> <span class="type">int</span> getMaximum() {
        <span class="keyword">return</span> (<span class="local-variable">this</span>.maximum);
    }

    <span class="directive">public</span> <span class="type">void</span> setMaximum(<span class="type">int</span> maximum) {
        <span class="local-variable">this</span>.maximum = maximum;
    }

    <span class="directive">public</span> <span class="type">int</span> getMinimum() {
        <span class="keyword">return</span> (<span class="local-variable">this</span>.minimum);
    }

    <span class="directive">public</span> <span class="type">void</span> setMinimum(<span class="type">int</span> minimum) {
        <span class="local-variable">this</span>.minimum = minimum;
    }

    <span class="directive">public</span> <span class="type">int</span> getRemainingGuesses() {
        <span class="keyword">return</span> remainingGuesses;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> check() <span class="directive">throws</span> <span class="exception">InterruptedException</span> {
        <span class="keyword">if</span> (userNumber &gt; number) {
            maximum = userNumber - <span class="integer">1</span>;
        }
        <span class="keyword">if</span> (userNumber &lt; number) {
            minimum = userNumber + <span class="integer">1</span>;
        }
        <span class="keyword">if</span> (userNumber == number) {
            FacesContext.getCurrentInstance().addMessage(<span class="predefined-constant">null</span>,
                <span class="keyword">new</span> FacesMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Correct!</span><span class="delimiter">&quot;</span></span>));
        }
        remainingGuesses--;
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> reset() {
        <span class="local-variable">this</span>.minimum = <span class="integer">0</span>;
        <span class="local-variable">this</span>.userNumber = <span class="integer">0</span>;
        <span class="local-variable">this</span>.remainingGuesses = <span class="integer">10</span>;
        <span class="local-variable">this</span>.maximum = maxNumber;
        <span class="local-variable">this</span>.number = randomInt.get();
    }

    <span class="directive">public</span> <span class="type">void</span> validateNumberRange(FacesContext context,
                                    UIComponent toValidate,
                                    <span class="predefined-type">Object</span> value) {
        <span class="type">int</span> input = (<span class="predefined-type">Integer</span>) value;

        <span class="keyword">if</span> (input &lt; minimum || input &gt; maximum) {
            ((UIInput) toValidate).setValid(<span class="predefined-constant">false</span>);

            FacesMessage message = <span class="keyword">new</span> FacesMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid guess</span><span class="delimiter">&quot;</span></span>);
            context.addMessage(toValidate.getClientId(context), message);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJDON"></a><a id="the-facelets-page"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_facelets_page">3.3.2. The Facelets Page</h4>
<div class="paragraph">
<p>This example uses the same template that the <code>simplegreeting</code> example
uses. The <code>index.xhtml</code> file, however, is more complex.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
          &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/facelets</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/jsf/html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;ui:composition</span> <span class="attribute-name">template</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/template.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Guess My Number<span class="tag">&lt;/ui:define&gt;</span>
        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">head</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Guess My Number<span class="tag">&lt;/ui:define&gt;</span>
        <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">GuessMain</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;div</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="value">black</span>; <span class="key">font-size</span>: <span class="float">24px</span>;<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;p&gt;</span>I'm thinking of a number from
                    <span class="tag">&lt;span</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="value">blue</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>#{userNumberBean.minimum}<span class="tag">&lt;/span&gt;</span>
                    to
                    <span class="tag">&lt;span</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="value">blue</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>#{userNumberBean.maximum}<span class="tag">&lt;/span&gt;</span>.
                    You have
                    <span class="tag">&lt;span</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="value">blue</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        #{userNumberBean.remainingGuesses}
                    <span class="tag">&lt;/span&gt;</span>
                    guesses.<span class="tag">&lt;/p&gt;</span>
                <span class="tag">&lt;/div&gt;</span>
                <span class="tag">&lt;h:panelGrid</span> <span class="attribute-name">border</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">columns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">font-size</span>: <span class="float">18px</span>;<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputGuess</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Number:<span class="tag">&lt;/h:outputLabel&gt;</span>
                    <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputGuess</span><span class="delimiter">&quot;</span></span>
                                 <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.userNumber}</span><span class="delimiter">&quot;</span></span>
                                 <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">disabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.number eq userNumberBean.userNumber or userNumberBean.remainingGuesses le 0}</span><span class="delimiter">&quot;</span></span>
                               <span class="attribute-name">validator</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.validateNumberRange}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;/h:inputText&gt;</span>
                    <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">GuessButton</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Guess</span><span class="delimiter">&quot;</span></span>
                                     <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.check}</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">disabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.number eq userNumberBean.userNumber or userNumberBean.remainingGuesses le 0}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RestartButton</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Reset</span><span class="delimiter">&quot;</span></span>
                                     <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.reset}</span><span class="delimiter">&quot;</span></span>
                                     <span class="attribute-name">immediate</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                    <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Higher</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Higher!</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.number gt userNumberBean.userNumber and userNumberBean.userNumber ne 0}</span><span class="delimiter">&quot;</span></span>
                                  <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="color">#d20005</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Lower</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Lower!</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{userNumberBean.number lt userNumberBean.userNumber and userNumberBean.userNumber ne 0}</span><span class="delimiter">&quot;</span></span>
                                  <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="color">#d20005</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/h:panelGrid&gt;</span>
                <span class="tag">&lt;div</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="color">#d20005</span>; <span class="key">font-size</span>: <span class="float">14px</span>;<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;h:messages</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">messages</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">globalOnly</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/div&gt;</span>
            <span class="tag">&lt;/h:form&gt;</span>
        <span class="tag">&lt;/ui:define&gt;</span>

    <span class="tag">&lt;/ui:composition&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Facelets page presents the user with the minimum and maximum values
and the number of guesses remaining. The user&#8217;s interaction with the
game takes place within the <code>panelGrid</code> table, which contains an input
field, <strong>Guess</strong> and <strong>Reset</strong> buttons, and a field that appears if the guess is
higher or lower than the correct number. Every time the user clicks
<strong>Guess</strong>, the <code>userNumberBean.check</code> method is called to reset the
maximum or minimum value or, if the guess is correct, to generate a
<code>FacesMessage</code> to that effect. The method that determines whether each
guess is valid is <code>userNumberBean.validateNumberRange</code>.</p>
</div>
<div class="paragraph">
<p><a id="GJDPW"></a><a id="running-the-guessnumber-cdi-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_guessnumber_cdi_example">3.3.3. Running the guessnumber-cdi Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>guessnumber-cdi</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GJDPS"></a><a id="to-build-package-and-deploy-the-guessnumber-cdi-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_guessnumber_cdi_example_using_netbeans_ide">To Build, Package, and Deploy the guessnumber-cdi Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the <strong>File</strong> menu, choose <strong>Open Project</strong>.</p>
</li>
<li>
<p>In the <strong>Open Project</strong> dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>guessnumber-cdi</code> folder.</p>
</li>
<li>
<p>Click <strong>Open Project</strong>.</p>
</li>
<li>
<p>In the <strong>Projects</strong> tab, right-click the <code>guessnumber-cdi</code> project and
select <strong>Build</strong>.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>guessnumber-cdi.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJDPR"></a><a id="to-build-package-and-deploy-the-guessnumber-cdi-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_guessnumber_cdi_example_using_maven">To Build, Package, and Deploy the guessnumber-cdi Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, change to the following directory:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/guessnumber-cdi/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>guessnumber-cdi.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJDQB"></a><a id="to-run-the-guessnumber-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_guessnumber_example">To Run the guessnumber Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/guessnumber-cdi</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>Guess My Number</strong> page opens.</p>
</div>
</li>
<li>
<p>On the <strong>Guess My Number</strong> page, enter a number in the <strong>Number</strong> field and
click <strong>Guess</strong>.</p>
<div class="paragraph">
<p>The minimum and maximum values are modified, along with the remaining
number of guesses.</p>
</div>
</li>
<li>
<p>Keep guessing numbers until you get the right answer or run out of
guesses.</p>
<div class="paragraph">
<p>If you get the right answer or run out of guesses, the input field and
<strong>Guess</strong> button are grayed out.</p>
</div>
</li>
<li>
<p>Click <strong>Reset</strong> to play the game again with a new random number.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jakarta_contexts_and_dependency_injection_advanced_topics">4. Jakarta Contexts and Dependency Injection: Advanced Topics</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GJEHI"></a><a id="contexts-and-dependency-injection-for-jakarta-ee-advanced-topics"></a></p>
</div>
<div class="paragraph">
<p>This chapter describes more advanced features of Jakarta Contexts and Dependency
Injection. Specifically, it covers additional features
CDI provides to enable loose coupling of components with strong typing,
in addition to those described in <a href="#GIWHL">Overview
of CDI</a>.</p>
</div>
<div class="paragraph">
<p><a id="CACDCFDE"></a><a id="packaging-cdi-applications"></a></p>
</div>
<div class="sect2">
<h3 id="_packaging_cdi_applications">4.1. Packaging CDI Applications</h3>
<div class="paragraph">
<p>When you deploy a Jakarta EE application, CDI looks for beans inside bean
archives. A bean archive is any module that contains beans that the CDI
runtime can manage and inject. There are two kinds of bean archives:
explicit bean archives and implicit bean archives.</p>
</div>
<div class="paragraph">
<p>An explicit bean archive is an archive that contains a <code>beans.xml</code>
deployment descriptor, which can be an empty file, contain no version
number, or contain the version number 1.1 with the <code>bean-discovery-mode</code>
attribute set to <code>all</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee</span>
                           <span class="content">http://xmlns.jcp.org/xml/ns/javaee/beans_1_1.xsd</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">bean-discovery-mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    ...
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>CDI can manage and inject any bean in an explicit archive, except those
annotated with <code>@Vetoed</code>.</p>
</div>
<div class="paragraph">
<p>An implicit bean archive is an archive that contains some beans
annotated with a scope type, contains no <code>beans.xml</code> deployment
descriptor, or contains a <code>beans.xml</code> deployment descriptor with the
<code>bean-discovery-mode</code> attribute set to <code>annotated</code>.</p>
</div>
<div class="paragraph">
<p>In an implicit archive, CDI can only manage and inject beans annotated
with a scope type.</p>
</div>
<div class="paragraph">
<p>For a web application, the <code>beans.xml</code> deployment descriptor, if
present, must be in the <code>WEB-INF</code> directory. For enterprise bean modules or JAR
files, the <code>beans.xml</code> deployment descriptor, if present, must be in the
<code>META-INF</code> directory.</p>
</div>
<div class="paragraph">
<p><a id="GJSDF"></a><a id="using-alternatives-in-cdi-applications"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_alternatives_in_cdi_applications">4.2. Using Alternatives in CDI Applications</h3>
<div class="paragraph">
<p>When you have more than one version of a bean that you use for different
purposes, you can choose between them during the development phase by
injecting one qualifier or another, as shown in
<a href="#GJBJU">The simplegreeting CDI Example</a>.</p>
</div>
<div class="paragraph">
<p>Instead of having to change the source code of your application,
however, you can make the choice at deployment time by using
alternatives.</p>
</div>
<div class="paragraph">
<p>Alternatives are commonly used for purposes such as the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To handle client-specific business logic that is determined at runtime</p>
</li>
<li>
<p>To specify beans that are valid for a particular deployment scenario
(for example, when country-specific sales tax laws require
country-specific sales tax business logic)</p>
</li>
<li>
<p>To create dummy (mock) versions of beans to be used for testing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To make a bean available for lookup, injection, or EL resolution using
this mechanism, give it a <code>javax.enterprise.inject.Alternative</code>
annotation and then use the <code>alternatives</code> element to specify it in the
<code>beans.xml</code> file.</p>
</div>
<div class="paragraph">
<p>For example, you might want to create a full version of a bean and also
a simpler version that you use only for certain kinds of testing. The
example described in <a href="#GKHPU">The encoder
Example: Using Alternatives</a> contains two such beans, <code>CoderImpl</code> and
<code>TestCoderImpl</code>. The test bean is annotated as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Alternative</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TestCoderImpl</span> <span class="directive">implements</span> Coder { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The full version is not annotated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CoderImpl</span> <span class="directive">implements</span> Coder { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The managed bean injects an instance of the <code>Coder</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
Coder coder;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The alternative version of the bean is used by the application only if
that version is declared as follows in the <code>beans.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">...</span><span class="tag">&gt;</span>
    <span class="tag">&lt;alternatives&gt;</span>
        <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.encoder.TestCoderImpl<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/alternatives&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>alternatives</code> element is commented out in the <code>beans.xml</code> file,
the <code>CoderImpl</code> class is used.</p>
</div>
<div class="paragraph">
<p>You can also have several beans that implement the same interface, all
annotated <code>@Alternative</code>. In this case, you must specify in the
<code>beans.xml</code> file which of these alternative beans you want to use. If
<code>CoderImpl</code> were also annotated <code>@Alternative</code>, one of the two beans
would always have to be specified in the <code>beans.xml</code> file.</p>
</div>
<div class="paragraph">
<p>The alternatives that you specify in the <code>beans.xml</code> file apply only to
classes in the same archive. Use the <code>@Priority</code> annotation to specify
alternatives globally for an application that consists of multiple
modules, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Alternative</span>
<span class="annotation">@Priority</span>(Interceptor.Priority.APPLICATION+<span class="integer">10</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TestCoderImpl</span> <span class="directive">implements</span> Coder { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The alternative with higher priority value is selected if several
alternative beans that implement the same interface are annotated with
<code>@Priority</code>. You do not need to specify the alternative in the
<code>beans.xml</code> file when you use the <code>@Priority</code> annotation.</p>
</div>
<div class="paragraph">
<p><a id="GKHPO"></a><a id="using-specialization"></a></p>
</div>
<div class="sect3">
<h4 id="_using_specialization">4.2.1. Using Specialization</h4>
<div class="paragraph">
<p>Specialization has a function similar to that of alternatives in that it
allows you to substitute one bean for another. However, you might want
to make one bean override the other in all cases. Suppose you defined
the following two beans:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Default</span> <span class="annotation">@Asynchronous</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AsynchronousService</span> <span class="directive">implements</span> Service { ... }

<span class="annotation">@Alternative</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MockAsynchronousService</span> <span class="directive">extends</span> AsynchronousService { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you then declared <code>MockAsynchronousService</code> as an alternative in your
<code>beans.xml</code> file, the following injection point would resolve to
<code>MockAsynchronousService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> Service service;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following, however, would resolve to <code>AsynchronousService</code> rather
than <code>MockAsynchronousService</code>, because <code>MockAsynchronousService</code> does
not have the <code>@Asynchronous</code> qualifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> <span class="annotation">@Asynchronous</span> Service service;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make sure that <code>MockAsynchronousService</code> was always injected, you
would have to implement all bean types and bean qualifiers of
<code>AsynchronousService</code>. However, if <code>AsynchronousService</code> declared a
producer method or observer method, even this cumbersome mechanism would
not ensure that the other bean was never invoked. Specialization
provides a simpler mechanism.</p>
</div>
<div class="paragraph">
<p>Specialization happens at development time as well as at runtime. If you
declare that one bean specializes another, it extends the other bean
class, and at runtime the specialized bean completely replaces the other
bean. If the first bean is produced by means of a producer method, you
must also override the producer method.</p>
</div>
<div class="paragraph">
<p>You specialize a bean by giving it the
<code>javax.enterprise.inject.Specializes</code> annotation. For example, you might
declare a bean as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Specializes</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MockAsynchronousService</span> <span class="directive">extends</span> AsynchronousService { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the <code>MockAsynchronousService</code> class will always be invoked
instead of the <code>AsynchronousService</code> class.</p>
</div>
<div class="paragraph">
<p>Usually, a bean marked with the <code>@Specializes</code> annotation is also an
alternative and is declared as an alternative in the <code>beans.xml</code> file.
Such a bean is meant to stand in as a replacement for the default
implementation, and the alternative implementation automatically
inherits all qualifiers of the default implementation as well as its EL
name, if it has one.</p>
</div>
<div class="paragraph">
<p><a id="GKGKV"></a><a id="using-producer-methods-producer-fields-and-disposer-methods-in-cdi-applications"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_producer_methods_producer_fields_and_disposer_methods_in_cdi_applications">4.3. Using Producer Methods, Producer Fields, and Disposer Methods in CDI Applications</h3>
<div class="paragraph">
<p>A producer method generates an object that can then be injected.
Typically, you use producer methods in the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When you want to inject an object that is not itself a bean</p>
</li>
<li>
<p>When the concrete type of the object to be injected may vary at
runtime</p>
</li>
<li>
<p>When the object requires some custom initialization that the bean
constructor does not perform</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on producer methods, see
<a href="#GJDID">Injecting Objects by Using Producer
Methods</a>.</p>
</div>
<div class="paragraph">
<p>A producer field is a simpler alternative to a producer method; it is a
field of a bean that generates an object. It can be used instead of a
simple getter method. Producer fields are particularly useful for
declaring Jakarta EE resources such as data sources, JMS resources, and web
service references.</p>
</div>
<div class="paragraph">
<p>A producer method or field is annotated with the
<code>javax.enterprise.inject.Produces</code> annotation.</p>
</div>
<div class="paragraph">
<p><a id="sthref127"></a><a id="using-producer-methods"></a></p>
</div>
<div class="sect3">
<h4 id="_using_producer_methods">4.3.1. Using Producer Methods</h4>
<div class="paragraph">
<p>A producer method can allow you to select a bean implementation at
runtime instead of at development time or deployment time. For example,
in the example described in <a href="#GKHPY">The
producermethods Example: Using a Producer Method to Choose a Bean
Implementation</a>, the managed bean defines the following producer method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Produces</span>
<span class="annotation">@Chosen</span>
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> Coder getCoder() {

    <span class="keyword">switch</span> (coderType) {
        <span class="keyword">case</span> TEST:
            <span class="keyword">return</span> <span class="keyword">new</span> TestCoderImpl();
        <span class="keyword">case</span> SHIFT:
            <span class="keyword">return</span> <span class="keyword">new</span> CoderImpl();
        <span class="keyword">default</span>:
            <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>getCoder</code> becomes in effect a getter method, and when the <code>coder</code>
property is injected with the same qualifier and other annotations as
the method, the selected version of the interface is used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
<span class="annotation">@Chosen</span>
<span class="annotation">@RequestScoped</span>
Coder coder;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Specifying the qualifier is essential: It tells CDI which <code>Coder</code> to
inject. Without it, the CDI implementation would not be able to choose
between <code>CoderImpl</code>, <code>TestCoderImpl</code>, and the one returned by <code>getCoder</code>
and would cancel deployment, informing the user of the ambiguous
dependency.</p>
</div>
<div class="paragraph">
<p><a id="sthref128"></a><a id="using-producer-fields-to-generate-resources"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_using_producer_fields_to_generate_resources">4.3.2. Using Producer Fields to Generate Resources</h4>
<div class="paragraph">
<p>A common use of a producer field is to generate an object such as a JDBC
<code>DataSource</code> or a Jakarta Persistence <code>EntityManager</code> (see
<a href="#BNBPZ">Chapter 40, "Introduction to Jakarta
Persistence,"</a> for more information). The object can then be managed
by the container. For example, you could create a <code>@UserDatabase</code>
qualifier and then declare a producer field for an entity manager as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Produces</span>
<span class="annotation">@UserDatabase</span>
<span class="annotation">@PersistenceContext</span>
<span class="directive">private</span> EntityManager em;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@UserDatabase</code> qualifier can be used when you inject the object
into another bean, <code>RequestBean</code>, elsewhere in the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Inject</span>
    <span class="annotation">@UserDatabase</span>
    EntityManager em;
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#GKHRG">The producerfields Example: Using
Producer Fields to Generate Resources</a> shows how to use producer fields
to generate an entity manager. You can use a similar mechanism to inject
<code>@Resource</code>, <code>@EJB</code>, or <code>@WebServiceRef</code> objects.</p>
</div>
<div class="paragraph">
<p>To minimize the reliance on resource injection, specify the producer
field for the resource in one place in the application, and then inject
the object wherever in the application you need it.</p>
</div>
<div class="paragraph">
<p><a id="sthref129"></a><a id="using-a-disposer-method"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_using_a_disposer_method">4.3.3. Using a Disposer Method</h4>
<div class="paragraph">
<p>You can use a producer method or a producer field to generate an object
that needs to be removed when its work is completed. If you do, you need
a corresponding disposer method, annotated with a <code>@Disposes</code>
annotation. For example, you can close the entity manager as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> close(<span class="annotation">@Disposes</span> <span class="annotation">@UserDatabase</span> EntityManager em) {
    em.close();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The disposer method is called automatically when the context ends (in
this case, at the end of the conversation, because <code>RequestBean</code> has
conversation scope), and the parameter in the <code>close</code> method receives
the object produced by the producer field.</p>
</div>
<div class="paragraph">
<p><a id="CJGHGDBA"></a><a id="using-predefined-beans-in-cdi-applications"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_predefined_beans_in_cdi_applications">4.4. Using Predefined Beans in CDI Applications</h3>
<div class="paragraph">
<p>Jakarta EE provides predefined beans that implement the following
interfaces.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.transaction.UserTransaction</code>: A Jakarta Transactions user
transaction.</p>
</li>
<li>
<p><code>java.security.Principal</code>: The abstract notion of a principal, which
represents any entity, such as an individual, a corporation, or a login
ID. Whenever the injected principal is accessed, it always represents
the identity of the current caller. For example, a principal is injected
into a field at initialization. Later, a method that uses the injected
principal is called on the object into which the principal was injected.
In this situation, the injected principal represents the identity of the
current caller when the method is run.</p>
</li>
<li>
<p><code>javax.validation.Validator</code>: A validator for bean instances. The bean
that implements this interface enables a <code>Validator</code> object for the
default bean validation object <code>ValidatorFactory</code> to be injected.</p>
</li>
<li>
<p><code>javax.validation.ValidatorFactory</code>: A factory class for returning
initialized <code>Validator</code> instances. The bean that implements this
interface enables the default bean validation <code>ValidatorFactory</code> object
to be injected.</p>
</li>
<li>
<p><code>javax.servlet.http.HttpServletRequest</code>: An HTTP request from a
client. The bean that implements this interface enables a servlet to
obtain all the details of a request.</p>
</li>
<li>
<p><code>javax.servlet.http.HttpSession</code>: An HTTP session between a client and
a server. The bean that implements this interface enables a servlet to
access information about a session and to bind objects to a session.</p>
</li>
<li>
<p><code>javax.servlet.ServletContext</code>: A context object that servlets can use
to communicate with the servlet container.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To inject a predefined bean, create an injection point to obtain an
instance of the bean by using the <code>javax.annotation.Resource</code> annotation
for resources or the <code>javax.inject.Inject</code> annotation for CDI beans. For
the bean type, specify the class name of the interface the bean
implements.</p>
</div>
<div class="paragraph">
<p><a id="sthref130"></a><a id="sthref131"></a></p>
</div>
<div class="paragraph">
<p><strong>Table 27-1 Injection of Predefined Beans</strong></p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Predefined Bean</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Resource or CDI Bean</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Injection Example</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UserTransaction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Resource UserTransaction transaction;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Principal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Resource Principal principal;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Validator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Resource Validator validator;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidatorFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Resource ValidatorFactory factory;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpServletRequest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDI bean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Inject HttpServletRequest req;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpSession</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDI bean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Inject HttpSession session;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletContext</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDI bean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Inject ServletContext context;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Predefined beans are injected with dependent scope and the predefined
default qualifier <code>@Default</code>.</p>
</div>
<div class="paragraph">
<p>For more information about injecting resources, see
<a href="#BABHDCAI">Resource Injection</a>.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how to use the <code>@Resource</code> and
<code>@Inject</code> annotations to inject predefined beans. This code snippet
injects a user transaction and a context object into the servlet class
<code>TransactionServlet</code>. The user transaction is an instance of the
predefined bean that implements the <code>javax.transaction.UserTransaction</code>
interface. The context object is an instance of the predefined bean that
implements the <code>javax.servlet.ServletContext</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.annotation.Resource</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServlet</span>;
<span class="keyword">import</span> <span class="include">jakarta.transaction.UserTransaction</span>;
...
public <span class="type">class</span> <span class="class">TransactionServlet</span> <span class="directive">extends</span> HttpServlet {
    <span class="annotation">@Resource</span> UserTransaction transaction;
    <span class="annotation">@Inject</span> ServletContext context;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKHIC"></a><a id="using-events-in-cdi-applications"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_events_in_cdi_applications">4.5. Using Events in CDI Applications</h3>
<div class="paragraph">
<p>Events allow beans to communicate without any compile-time dependency.
One bean can define an event, another bean can fire the event, and yet
another bean can handle the event. In addition, events can be fired asynchronously. The beans can be in separate packages
and even in separate tiers of the application.</p>
</div>
<div class="sect3">
<h4 id="defining-events">4.5.1. Defining Events</h4>
<div class="paragraph">
<p>An event consists of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The event object, a Java object</p>
</li>
<li>
<p>Zero or more qualifier types, the event qualifiers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, in the <code>billpayment</code> example described in
<a href="#GKHPA">The billpayment Example: Using Events
and Interceptors</a>, a <code>PaymentEvent</code> bean defines an event using three
properties, which have setter and getter methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="predefined-type">String</span> paymentType;
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> value;
    <span class="directive">public</span> <span class="predefined-type">Date</span> datetime;

    <span class="directive">public</span> PaymentEvent() {
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example also defines qualifiers that distinguish between two kinds
of <code>PaymentEvent</code>. Every event also has the default qualifier <code>@Any</code>.</p>
</div>
<div class="paragraph">
<p><a id="GKHNF"></a><a id="using-observer-methods-to-handle-events"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_using_observer_methods_to_handle_events">4.5.2. Using Observer Methods to Handle Events</h4>
<div class="paragraph">
<p>An event handler uses an observer method to consume events.</p>
</div>
<div class="paragraph">
<p>Each observer method takes as a parameter an event of a specific event
type that is annotated with the <code>@Observes</code> annotation and with any
qualifiers for that event type. The observer method is notified of an
event if the event object matches the event type and if all the
qualifiers of the event match the observer method event qualifiers.</p>
</div>
<div class="paragraph">
<p>The observer method can take other parameters in addition to the event
parameter. The additional parameters are injection points and can
declare qualifiers.</p>
</div>
<div class="paragraph">
<p>The event handler for the <code>billpayment</code> example, <code>PaymentHandler</code>,
defines two observer methods, one for each type of <code>PaymentEvent</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> creditPayment(<span class="annotation">@Observes</span> <span class="annotation">@Credit</span> PaymentEvent event) {
    ...
}

<span class="directive">public</span> <span class="type">void</span> debitPayment(<span class="annotation">@Observes</span> <span class="annotation">@Debit</span> PaymentEvent event) {
    ...
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="conditional-and-transactional-observer-methods">Conditional and Transactional Observer Methods</h5>
<div class="paragraph">
<p>Observer methods can also be conditional or transactional:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A conditional observer method is notified of an event only if an
instance of the bean that defines the observer method already exists in
the current context. To declare a conditional observer method, specify
<code>notifyObserver=IF_EXISTS</code> as an argument to <code>@Observes</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Observes</span>(notifyObserver=IF_EXISTS)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To obtain the default unconditional behavior, you can specify
<code>@Observes(notifyObserver=ALWAYS)</code>.</p>
</div>
</li>
<li>
<p>A transactional observer method is notified of an event during the
before-completion or after-completion phase of the transaction in which
the event was fired. You can also specify that the notification is to
occur only after the transaction has completed successfully or
unsuccessfully. To specify a transactional observer method, use any of
the following arguments to <code>@Observes</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Observes</span>(during=BEFORE_COMPLETION)

<span class="annotation">@Observes</span>(during=AFTER_COMPLETION)

<span class="annotation">@Observes</span>(during=AFTER_SUCCESS)

<span class="annotation">@Observes</span>(during=AFTER_FAILURE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To obtain the default nontransactional behavior, specify
<code>@Observes(during=IN_PROGRESS)</code>.</p>
</div>
<div class="paragraph">
<p>An observer method that is called before completion of a transaction may
call the <code>setRollbackOnly</code> method on the transaction instance to force a
transaction rollback.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Observer methods may throw exceptions. If a transactional observer
method throws an exception, the exception is caught by the container. If
the observer method is nontransactional, the exception terminates
processing of the event, and no other observer methods for the event are
called.</p>
</div>
</div>
<div class="sect4">
<h5 id="observer-method-ordering">Observer Method Ordering</h5>
<div class="paragraph">
<p>Before a certain observer event notification is generated, the container determines the order in which observer methods for that event are invoked. Observer method order is established through the declaration of the <code>@Priority</code> annotation on an event parameter of an observer method, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">void</span> afterLogin(<span class="annotation">@Observes</span> <span class="annotation">@Priority</span>(javax.interceptor.Interceptor.Priority.APPLICATION) LoggedInEvent event) { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>@Priority</code> annotation is not specified, the default value is <code>javax.interceptor.Interceptor.Priority.APPLICATION + 500</code>.</p>
</li>
<li>
<p>If two or more observer methods are assigned the same priority, the order in which they are invoked is undefined and is therefore unpredictable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GKHIH"></a><a id="firing-events"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_firing_events">4.5.3. Firing Events</h4>
<div class="paragraph">
<p>Beans fire events by implementing an instance of the <code>javax.enterprise.event.Event</code> interface. Events can be fired synchronously or asynchronously.</p>
</div>
<div class="sect4">
<h5 id="firing-events-synchronously">Firing Events Synchronously</h5>
<div class="paragraph">
<p>To activate an event synchronously, call the <code>javax.enterprise.event.Event.fire</code>
method. This method fires an event and notifies any observer methods.</p>
</div>
<div class="paragraph">
<p>In the <code>billpayment</code> example, a managed bean called <code>PaymentBean</code> fires
the appropriate event by using information it receives from the user
interface. There are actually four event beans, two for the event object
and two for the payload. The managed bean injects the two event beans.
The <code>pay</code> method uses a <code>switch</code> statement to choose which event to
fire, using <code>new</code> to create the payload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Inject</span>
    <span class="annotation">@Credit</span>
    <span class="predefined-type">Event</span>&lt;PaymentEvent&gt; creditEvent;

    <span class="annotation">@Inject</span>
    <span class="annotation">@Debit</span>
    <span class="predefined-type">Event</span>&lt;PaymentEvent&gt; debitEvent;

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">int</span> DEBIT = <span class="integer">1</span>;
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">int</span> CREDIT = <span class="integer">2</span>;
    <span class="directive">private</span> <span class="type">int</span> paymentOption = DEBIT;
    ...

    <span class="annotation">@Logged</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> pay() {
        ...
        switch (paymentOption) {
            <span class="keyword">case</span> DEBIT:
                PaymentEvent debitPayload = <span class="keyword">new</span> PaymentEvent();
                <span class="comment">// populate payload ...</span>
                debitEvent.fire(debitPayload);
                <span class="keyword">break</span>;
            <span class="keyword">case</span> CREDIT:
                PaymentEvent creditPayload = <span class="keyword">new</span> PaymentEvent();
                <span class="comment">// populate payload ...</span>
                creditEvent.fire(creditPayload);
                <span class="keyword">break</span>;
            <span class="keyword">default</span>:
                logger.severe(<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid payment option!</span><span class="delimiter">&quot;</span></span>);
        }
        ...
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument to the <code>fire</code> method is a <code>PaymentEvent</code> that contains the
payload. The fired event is then consumed by the observer methods.</p>
</div>
</div>
<div class="sect4">
<h5 id="firing-events-asynchronously">Firing Events Asynchronously</h5>
<div class="paragraph">
<p>To activate an event asynchronously, call the <code>javax.enterprise.event.Event.fireAsync</code> method. This method calls all resolved asynchronous observers in one or more different threads.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> <span class="predefined-type">Event</span>&lt;LoggedInEvent&gt; loggedInEvent;

<span class="directive">public</span> <span class="type">void</span> login() {
    ...
    loggedInEvent.fireAsync( <span class="keyword">new</span> LoggedInEvent(user) );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The invocation of the <code>fireAsync()</code> method returns immediately.</p>
</div>
<div class="paragraph">
<p>When events are fired asynchronously, observer methods are notified asynchronously. Consequently, observer method ordering cannot be guaranteed, because observer method invocation and the firing of asynchronous events occur on separate threads.</p>
</div>
<div class="paragraph">
<p><a id="GKHJX"></a><a id="using-interceptors-in-cdi-applications"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_interceptors_in_cdi_applications">4.6. Using Interceptors in CDI Applications</h3>
<div class="paragraph">
<p>An interceptor is a class used to interpose in method invocations or
lifecycle events that occur in an associated target class. The
interceptor performs tasks, such as logging or auditing, that are
separate from the business logic of the application and are repeated
often within an application. Such tasks are often called cross-cutting
tasks. Interceptors allow you to specify the code for these tasks in one
place for easy maintenance. When interceptors were first introduced to
the Jakarta EE platform, they were specific to enterprise beans. On the
Jakarta EE platform, you can use them with Jakarta EE managed objects of all
kinds, including managed beans.</p>
</div>
<div class="paragraph">
<p>For information on Jakarta EE interceptors, see
<a href="#GKEED">Chapter 57, "Using Jakarta EE Interceptors"</a>.</p>
</div>
<div class="paragraph">
<p>An interceptor class often contains a method annotated <code>@AroundInvoke</code>,
which specifies the tasks the interceptor will perform when intercepted
methods are invoked. It can also contain a method annotated
<code>@PostConstruct</code>, <code>@PreDestroy</code>, <code>@PrePassivate</code>, or <code>@PostActivate</code>, to
specify lifecycle callback interceptors, and a method annotated
<code>@AroundTimeout</code>, to specify enterprise bean timeout interceptors. An interceptor
class can contain more than one interceptor method, but it must have no
more than one method of each type.</p>
</div>
<div class="paragraph">
<p>Along with an interceptor, an application defines one or more
interceptor binding types, which are annotations that associate an
interceptor with target beans or methods. For example, the <code>billpayment</code>
example contains an interceptor binding type named <code>@Logged</code> and an
interceptor named <code>LoggedInterceptor</code>. The interceptor binding type
declaration looks something like a qualifier declaration, but it is
annotated with <code>javax.interceptor.InterceptorBinding</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inherited</span>
<span class="annotation">@InterceptorBinding</span>
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>({METHOD, TYPE})
<span class="directive">public</span> <span class="annotation">@interface</span> Logged {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An interceptor binding also has the <code>java.lang.annotation.Inherited</code>
annotation, to specify that the annotation can be inherited from
superclasses. The <code>@Inherited</code> annotation also applies to custom scopes
(not discussed in this tutorial) but does not apply to qualifiers.</p>
</div>
<div class="paragraph">
<p>An interceptor binding type may declare other interceptor bindings.</p>
</div>
<div class="paragraph">
<p>The interceptor class is annotated with the interceptor binding as well
as with the <code>@Interceptor</code> annotation. For an example, see
<a href="#GKHRQ">The LoggedInterceptor Interceptor
Class</a>.</p>
</div>
<div class="paragraph">
<p>Every <code>@AroundInvoke</code> method takes a
<code>javax.interceptor.InvocationContext</code> argument, returns a
<code>java.lang.Object</code>, and throws an <code>Exception</code>. It can call
<code>InvocationContext</code> methods. The <code>@AroundInvoke</code> method must call the
<code>proceed</code> method, which causes the target class method to be invoked.</p>
</div>
<div class="paragraph">
<p>Once an interceptor and binding type are defined, you can annotate beans
and individual methods with the binding type to specify that the
interceptor is to be invoked either on all methods of the bean or on
specific methods. For example, in the <code>billpayment</code> example, the
<code>PaymentHandler</code> bean is annotated <code>@Logged</code>, which means that any
invocation of its business methods will cause the interceptor&#8217;s
<code>@AroundInvoke</code> method to be invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Logged</span>
<span class="annotation">@SessionScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PaymentHandler</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, in the <code>PaymentBean</code> bean, only the <code>pay</code> and <code>reset</code> methods
have the <code>@Logged</code> annotation, so the interceptor is invoked only when
these methods are invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Logged</span>
<span class="directive">public</span> <span class="predefined-type">String</span> pay() {...}

<span class="annotation">@Logged</span>
<span class="directive">public</span> <span class="type">void</span> reset() {...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order for an interceptor to be invoked in a CDI application, it must,
like an alternative, be specified in the <code>beans.xml</code> file. For example,
the <code>LoggedInterceptor</code> class is specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interceptors&gt;</span>
    <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.billpayment.interceptors.LoggedInterceptor<span class="tag">&lt;/class&gt;</span>
<span class="tag">&lt;/interceptors&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If an application uses more than one interceptor, the interceptors are
invoked in the order specified in the <code>beans.xml</code> file.</p>
</div>
<div class="paragraph">
<p>The interceptors that you specify in the <code>beans.xml</code> file apply only to
classes in the same archive. Use the <code>@Priority</code> annotation to specify
interceptors globally for an application that consists of multiple
modules, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Logged</span>
<span class="annotation">@Interceptor</span>
<span class="annotation">@Priority</span>(Interceptor.Priority.APPLICATION)
<span class="directive">public</span> <span class="type">class</span> <span class="class">LoggedInterceptor</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Interceptors with lower priority values are called first. You do not
need to specify the interceptor in the <code>beans.xml</code> file when you use the
<code>@Priority</code> annotation.</p>
</div>
<div class="paragraph">
<p><a id="GKHQF"></a><a id="using-decorators-in-cdi-applications"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_decorators_in_cdi_applications">4.7. Using Decorators in CDI Applications</h3>
<div class="paragraph">
<p>A decorator is a Java class that is annotated
<code>javax.decorator.Decorator</code> and that has a corresponding <code>decorators</code>
element in the <code>beans.xml</code> file.</p>
</div>
<div class="paragraph">
<p>A decorator bean class must also have a delegate injection point, which
is annotated <code>javax.decorator.Delegate</code>. This injection point can be a
field, a constructor parameter, or an initializer method parameter of
the decorator class.</p>
</div>
<div class="paragraph">
<p>Decorators are outwardly similar to interceptors. However, they actually
perform tasks complementary to those performed by interceptors.
Interceptors perform cross-cutting tasks associated with method
invocation and with the lifecycles of beans, but cannot perform any
business logic. Decorators, on the other hand, do perform business logic
by intercepting business methods of beans. This means that instead of
being reusable for different kinds of applications, as are interceptors,
their logic is specific to a particular application.</p>
</div>
<div class="paragraph">
<p>For example, instead of using an alternative <code>TestCoderImpl</code> class for
the <code>encoder</code> example, you could create a decorator as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Decorator</span>
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">CoderDecorator</span> <span class="directive">implements</span> Coder {

    <span class="annotation">@Inject</span>
    <span class="annotation">@Delegate</span>
    <span class="annotation">@Any</span>
    Coder coder;

    <span class="directive">public</span> <span class="predefined-type">String</span> codeString(<span class="predefined-type">String</span> s, <span class="type">int</span> tval) {
        <span class="type">int</span> len = s.length();

        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span> + s + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content"> becomes </span><span class="delimiter">&quot;</span></span> + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span> + coder.codeString(s, tval)
                + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span> + len + <span class="string"><span class="delimiter">&quot;</span><span class="content"> characters in length</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#GKPAX">The decorators Example:
Decorating a Bean</a> for an example that uses this decorator.</p>
</div>
<div class="paragraph">
<p>This simple decorator returns more detailed output than the encoded
string returned by the <code>CoderImpl.codeString</code> method. A more complex
decorator could store information in a database or perform some other
business logic.</p>
</div>
<div class="paragraph">
<p>A decorator can be declared as an abstract class so that it does not
have to implement all the business methods of the interface.</p>
</div>
<div class="paragraph">
<p>In order for a decorator to be invoked in a CDI application, it must,
like an interceptor or an alternative, be specified in the <code>beans.xml</code>
file. For example, the <code>CoderDecorator</code> class is specified as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;decorators&gt;</span>
    <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.decorators.CoderDecorator<span class="tag">&lt;/class&gt;</span>
<span class="tag">&lt;/decorators&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If an application uses more than one decorator, the decorators are
invoked in the order in which they are specified in the <code>beans.xml</code>
file.</p>
</div>
<div class="paragraph">
<p>If an application has both interceptors and decorators, the interceptors
are invoked first. This means, in effect, that you cannot intercept a
decorator.</p>
</div>
<div class="paragraph">
<p>The decorators that you specify in the <code>beans.xml</code> file apply only to
classes in the same archive. Use the <code>@Priority</code> annotation to specify
decorators globally for an application that consists of multiple
modules, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Decorator</span>
<span class="annotation">@Priority</span>(Interceptor.Priority.APPLICATION)
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">CoderDecorator</span> <span class="directive">implements</span> Coder { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Decorators with lower priority values are called first. You do not need
to specify the decorator in the <code>beans.xml</code> when you use the <code>@Priority</code>
annotation.</p>
</div>
<div class="paragraph">
<p><a id="GKHQC"></a><a id="using-stereotypes-in-cdi-applications"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_stereotypes_in_cdi_applications">4.8. Using Stereotypes in CDI Applications</h3>
<div class="paragraph">
<p>A stereotype is a kind of annotation, applied to a bean, that
incorporates other annotations. Stereotypes can be particularly useful
in large applications in which you have a number of beans that perform
similar functions. A stereotype is a kind of annotation that specifies
the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A default scope</p>
</li>
<li>
<p>Zero or more interceptor bindings</p>
</li>
<li>
<p>Optionally, a <code>@Named</code> annotation, guaranteeing default EL naming</p>
</li>
<li>
<p>Optionally, an <code>@Alternative</code> annotation, specifying that all beans
with this stereotype are alternatives</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A bean annotated with a particular stereotype will always use the
specified annotations, so you do not have to apply the same annotations
to many beans.</p>
</div>
<div class="paragraph">
<p>For example, you might create a stereotype named <code>Action</code>, using the
<code>javax.enterprise.inject.Stereotype</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>
<span class="annotation">@Secure</span>
<span class="annotation">@Transactional</span>
<span class="annotation">@Named</span>
<span class="annotation">@Stereotype</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Action</span> {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All beans annotated <code>@Action</code> will have request scope, use default EL
naming, and have the interceptor bindings <code>@Transactional</code> and
<code>@Secure</code>.</p>
</div>
<div class="paragraph">
<p>You could also create a stereotype named <code>Mock</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Alternative</span>
<span class="annotation">@Stereotype</span>
<span class="annotation">@Target</span>(TYPE)
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Mock {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All beans with this annotation are alternatives.</p>
</div>
<div class="paragraph">
<p>It is possible to apply multiple stereotypes to the same bean, so you
can annotate a bean as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Action</span>
<span class="annotation">@Mock</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MockLoginAction</span> <span class="directive">extends</span> LoginAction { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to override the scope specified by a stereotype,
simply by specifying a different scope for the bean. The following
declaration gives the <code>MockLoginAction</code> bean session scope instead of
request scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SessionScoped</span>
<span class="annotation">@Action</span>
<span class="annotation">@Mock</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MockLoginAction</span> <span class="directive">extends</span> LoginAction { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>CDI makes available a built-in stereotype called <code>Model</code>, which is
intended for use with beans that define the model layer of a
model-view-controller application architecture. This stereotype
specifies that a bean is both <code>@Named</code> and <code>@RequestScoped</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>
<span class="annotation">@RequestScoped</span>
<span class="annotation">@Stereotype</span>
<span class="annotation">@Target</span>({TYPE, METHOD, FIELD})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Model {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-built-in-annotation-literals">4.9. Using the Built-In Annotation Literals</h3>
<div class="paragraph">
<p>The following built-in annotations define a <code>Literal</code> static nested class, which can be used as a convenience feature for creating instances of annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.enterprise.inject.Any</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.Default</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.New</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.Specializes</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.Vetoed</code></p>
</li>
<li>
<p><code>javax.enterprise.util.Nonbinding</code></p>
</li>
<li>
<p><code>javax.enterprise.context.Initialized</code></p>
</li>
<li>
<p><code>javax.enterprise.context.Destroyed</code></p>
</li>
<li>
<p><code>javax.enterprise.context.RequestScoped</code></p>
</li>
<li>
<p><code>javax.enterprise.context.SessionScoped</code></p>
</li>
<li>
<p><code>javax.enterprise.context.ApplicationScoped</code></p>
</li>
<li>
<p><code>javax.enterprise.context.Dependent</code></p>
</li>
<li>
<p><code>javax.enterprise.context.ConversationScoped</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.Alternative</code></p>
</li>
<li>
<p><code>javax.enterprise.inject.Typed</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-configurators-interfaces">4.10. Using the Configurators Interfaces</h3>
<div class="paragraph">
<p>The CDI 2.0 specification defines the following Configurators interfaces, which are used for dynamically defining and modifying CDI objects:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 99%;">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AnnotatedTypeConfigurator</code> SPI</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps create and configure the following type metadata:</p>
</div>
<div class="paragraph">
<p><code>AnnotatedType</code></p>
</div>
<div class="paragraph">
<p><code>AnnotatedField</code></p>
</div>
<div class="paragraph">
<p><code>AnnotatedConstructor</code></p>
</div>
<div class="paragraph">
<p><code>AnnotatedMethod</code></p>
</div>
<div class="paragraph">
<p><code>AnnotatedParameter</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>InjectionPointConfigurator</code> interface</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps configure an existing <code>InjectionPoint</code> instance</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BeanAttributesConfigurator</code> interface</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps configure a new <code>BeanAttributes</code> instance</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BeanConfigurator</code> interface</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps configure a new <code>Bean</code> instance</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ObserverMethodConfigurator</code> interface</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps configure an <code>ObserverMethod</code> instance</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ProducerConfigurator</code> interface</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Helps configure a <code>Producer</code> instance</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrapping-a-cdi-container-in-java-se">5. Bootstrapping a CDI Container in Java SE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter explains how to use the API for bootstrapping a CDI container in Java SE. This capability allows you to run CDI applications on Java SE and obtain beans, independently of an application server or any Jakarta EE APIs.</p>
</div>
<div class="paragraph">
<p>For more information about bootstrapping a CDI container in Java SE, see the <em>Weld Reference Guide</em> at <code><a href="http://weld.cdi-spec.org/documentation/" class="bare">http://weld.cdi-spec.org/documentation/</a></code>.</p>
</div>
<div class="sect2">
<h3 id="the-bootstrap-api">5.1. The Bootstrap API</h3>
<div class="paragraph">
<p>The API for bootstrapping a CDI container in Java SE consists of the following entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.enterprise.inject.se.SeContainerInitializer</code> class  Allows you to configure and bootstrap the CDI container. This class includes the following key methods:</p>
<div class="ulist">
<ul>
<li>
<p><code>newInstance()</code> obtains a <code>SeContainerInitializer</code> instance, which allows you to configure the container prior to bootstrapping it.</p>
</li>
<li>
<p><code>initialize()</code> bootstraps the container.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>javax.enterprise.inject.se.SeContainer</code> interface  Provides access to the <code>BeanManager</code> instance for programmatic lookup, as defined in the <code>SeContainer</code> interface, which is described at <code><a href="https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#se_container" class="bare">https://jakarta.ee/specifications/cdi/2.0/cdi-spec-2.0.html#se_container</a></code>.</p>
<div id="configuring-the-cdi-container" class="paragraph">
<p>== Configuring the CDI Container</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration of the <code>SeContainerInitializer</code> instance allows the explicit addition of elements into an internal <strong>synthetic bean archive</strong>. The synthetic bean archive represents the set of beans that have been loaded while initializing the container. The contents of the synthetic bean archive depend on whether discovery is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If discovery is enabled, the synthetic bean archive is created using standard bean discovery rules and contains a superset of all JAR files on the classpath. Archives that do not include a <code>beans.xml</code> file are excluded.</p>
</li>
<li>
<p>If discovery is disabled, and beans are added programmatically, the synthetic bean archive contains only the beans that have been programmatically added.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_advanced_contexts_and_dependency_injection_examples">6. Running the Advanced Contexts and Dependency Injection Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GKHRE"></a><a id="running-the-advanced-contexts-and-dependency-injection-examples"></a></p>
</div>
<div class="paragraph">
<p>This chapter describes in detail how to build and run several advanced
examples that use CDI.</p>
</div>
<div class="paragraph">
<p><a id="A1251406"></a><a id="building-and-running-the-cdi-advanced-examples"></a></p>
</div>
<div class="sect2">
<h3 id="_building_and_running_the_cdi_advanced_examples">6.1. Building and Running the CDI Advanced Examples</h3>
<div class="paragraph">
<p>The examples are in the <code><em>tut-install</em>/examples/cdi/</code> directory. To build
and run the examples, you will do the following.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use NetBeans IDE or the Maven tool to compile, package, and deploy
the example.</p>
</li>
<li>
<p>Run the example in a web browser.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See <a href="#GFIUD">Chapter 2, "Using the Tutorial
Examples"</a>, for basic information on installing, building, and running
the examples.</p>
</div>
<div class="paragraph">
<p><a id="GKHPU"></a><a id="the-encoder-example-using-alternatives"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_the_encoder_example_using_alternatives">6.2. The encoder Example: Using Alternatives</h3>
<div class="paragraph">
<p>The <code>encoder</code> example shows how to use alternatives to choose between
two beans at deployment time, as described in
<a href="#GJSDF">Using Alternatives in CDI Applications</a>. The
example includes an interface and two implementations of it, a managed
bean, a Facelets page, and configuration files.</p>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/encoder/src/main/java/ee/jakarta/tutorial/encoder/</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="GKHQA"></a><a id="the-coder-interface-and-implementations"></a></p>
</div>
<div class="sect3">
<h4 id="_the_coder_interface_and_implementations">6.2.1. The Coder Interface and Implementations</h4>
<div class="paragraph">
<p>The <code>Coder</code> interface contains just one method, <code>codeString</code>, that takes
two arguments: a string, and an integer value that specifies how the
letters in the string should be transposed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Coder</span> {

    <span class="directive">public</span> <span class="predefined-type">String</span> codeString(<span class="predefined-type">String</span> s, <span class="type">int</span> tval);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The interface has two implementation classes, <code>CoderImpl</code> and
<code>TestCoderImpl</code>. The implementation of <code>codeString</code> in <code>CoderImpl</code>
shifts the string argument forward in the alphabet by the number of
letters specified in the second argument; any characters that are not
letters are left unchanged. (This simple shift code is known as a Caesar
cipher because Julius Caesar reportedly used it to communicate with his
generals.) The implementation in <code>TestCoderImpl</code> merely displays the
values of the arguments. The <code>TestCoderImpl</code> implementation is annotated
<code>@Alternative</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.enterprise.inject.Alternative</span>;

<span class="annotation">@Alternative</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TestCoderImpl</span> <span class="directive">implements</span> Coder {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> codeString(<span class="predefined-type">String</span> s, <span class="type">int</span> tval) {
        <span class="keyword">return</span> (<span class="string"><span class="delimiter">&quot;</span><span class="content">input string is </span><span class="delimiter">&quot;</span></span> + s + <span class="string"><span class="delimiter">&quot;</span><span class="content">, shift value is </span><span class="delimiter">&quot;</span></span> + tval);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>beans.xml</code> file for the <code>encoder</code> example contains an
<code>alternatives</code> element for the <code>TestCoderImpl</code> class, but by default the
element is commented out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">...</span><span class="tag">&gt;</span>
    <span class="comment">&lt;!--&lt;alternatives&gt;
        &lt;class&gt;ee.jakarta.tutorial.encoder.TestCoderImpl&lt;/class&gt;
    &lt;/alternatives&gt;--&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This means that by default, the <code>TestCoderImpl</code> class, annotated
<code>@Alternative</code>, will not be used. Instead, the <code>CoderImpl</code> class will be
used.</p>
</div>
<div class="paragraph">
<p><a id="GKHPM"></a><a id="the-encoder-facelets-page-and-managed-bean"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_encoder_facelets_page_and_managed_bean">6.2.2. The encoder Facelets Page and Managed Bean</h4>
<div class="paragraph">
<p>The simple Facelets page for the <code>encoder</code> example, <code>index.xhtml</code>, asks
the user to enter the string and integer values and passes them to the
managed bean, <code>CoderBean</code>, as <code>coderBean.inputString</code> and
<code>coderBean.transVal</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;h:head&gt;</span>
        <span class="tag">&lt;h:outputStylesheet</span> <span class="attribute-name">library</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">css</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default.css</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;title&gt;</span>String Encoder<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;/h:head&gt;</span>
    <span class="tag">&lt;h:body&gt;</span>
        <span class="tag">&lt;h2&gt;</span>String Encoder<span class="tag">&lt;/h2&gt;</span>
        <span class="tag">&lt;p&gt;</span>Type a string and an integer, then click Encode.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;p&gt;</span>Depending on which alternative is enabled, the coder bean
            will either display the argument values or return a string that
            shifts the letters in the original string by the value you
            specify. The value must be between 0 and 26.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encodeit</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter a string: </span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputString</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputString</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.inputString}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the number of letters to shift by: </span><span class="delimiter">&quot;</span></span>
                               <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transVal</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">transVal</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.transVal}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Encode</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.encodeString()}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Result: </span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">outputString</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">outputString</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.codedString}</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>:<span class="value">blue</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Reset</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.reset}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        ...
    <span class="tag">&lt;/h:body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the user clicks the Encode button, the page invokes the managed
bean&#8217;s <code>encodeString</code> method and displays the result,
<code>coderBean.codedString</code>, in blue. The page also has a Reset button that
clears the fields.</p>
</div>
<div class="paragraph">
<p>The managed bean, <code>CoderBean</code>, is a <code>@RequestScoped</code> bean that declares
its input and output properties. The <code>transVal</code> property has three Bean
Validation constraints that enforce limits on the integer value, so that
if the user enters an invalid value, a default error message appears on
the Facelets page. The bean also injects an instance of the <code>Coder</code>
interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CoderBean</span> {

    <span class="directive">private</span> <span class="predefined-type">String</span> inputString;
    <span class="directive">private</span> <span class="predefined-type">String</span> codedString;
    <span class="annotation">@Max</span>(<span class="integer">26</span>)
    <span class="annotation">@Min</span>(<span class="integer">0</span>)
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="type">int</span> transVal;

    <span class="annotation">@Inject</span>
    Coder coder;
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to simple getter and setter methods for the three
properties, the bean defines the <code>encodeString</code> action method called by
the Facelets page. This method sets the <code>codedString</code> property to the
value returned by a call to the <code>codeString</code> method of the <code>Coder</code>
implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">void</span> encodeString() {
        setCodedString(coder.codeString(inputString, transVal));
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the bean defines the <code>reset</code> method to empty the fields of the
Facelets page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">void</span> reset() {
        setInputString(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
        setTransVal(<span class="integer">0</span>);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKHQQ"></a><a id="running-the-encoder-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_encoder_example">6.2.3. Running the encoder Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>encoder</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GKHOW"></a><a id="to-build-package-and-deploy-the-encoder-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_encoder_example_using_netbeans_ide">To Build, Package, and Deploy the encoder Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>encoder</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>encoder</code> project and select
Build.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>encoder.war</code>, located in the <code>target</code> directory, and then deploys it to
GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHQU"></a><a id="to-run-the-encoder-example-using-netbeans-ide"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_encoder_example_using_netbeans_ide">To Run the encoder Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/encoder</span></code></pre>
</div>
</div>
</li>
<li>
<p>On the String Encoder page, enter a string and the number of letters
to shift by, and then click Encode.</p>
<div class="paragraph">
<p>The encoded string appears in blue on the Result line. For example, if
you enter <code>Java</code> and <code>4</code>, the result is <code>Neze</code>.</p>
</div>
</li>
<li>
<p>Now, edit the <code>beans.xml</code> file to enable the alternative
implementation of <code>Coder</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>In the Projects tab, under the <code>encoder</code> project, expand the Web
Pages node, then expand the WEB-INF node.</p>
</li>
<li>
<p>Double-click the <code>beans.xml</code> file to open it.</p>
</li>
<li>
<p>Remove the comment characters that surround the <code>alternatives</code>
element, so that it looks like this:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;alternatives&gt;
    &lt;<span class="type">class</span>&gt;<span class="class">ee</span>.jakarta.tutorial.encoder.TestCoderImpl&lt;/<span class="type">class</span>&gt;
&lt;/<span class="class">alternatives</span>&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Save the file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Right-click the <code>encoder</code> project and select Clean and Build.</p>
</li>
<li>
<p>In the web browser, reenter the URL to show the String Encoder page
for the redeployed project:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/encoder/</span></code></pre>
</div>
</div>
</li>
<li>
<p>Enter a string and the number of letters to shift by, and then click
Encode.</p>
<div class="paragraph">
<p>This time, the Result line displays your arguments. For example, if you
enter <code>Java</code> and <code>4</code>, the result is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Result</span>: input string is Java, shift value is <span class="integer">4</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHQL"></a><a id="to-build-package-and-deploy-the-encoder-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_encoder_example_using_maven">To Build, Package, and Deploy the encoder Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/encoder/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>encoder.war</code>, located in the <code>target</code> directory, and then deploys it to
GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHOL"></a><a id="to-run-the-encoder-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_encoder_example_using_maven">To Run the encoder Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/encoder/</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The String Encoder page opens.</p>
</div>
</li>
<li>
<p>Enter a string and the number of letters to shift by, and then click
Encode.</p>
<div class="paragraph">
<p>The encoded string appears in blue on the Result line. For example, if
you enter <code>Java</code> and <code>4</code>, the result is <code>Neze</code>.</p>
</div>
</li>
<li>
<p>Now, edit the <code>beans.xml</code> file to enable the alternative
implementation of <code>Coder</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>In a text editor, open the following file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/encoder/src/main/webapp/WEB-INF/beans.xml</code></pre>
</div>
</div>
</li>
<li>
<p>Remove the comment characters that surround the <code>alternatives</code>
element, so that it looks like this:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;alternatives&gt;
    &lt;<span class="type">class</span>&gt;<span class="class">ee</span>.jakarta.tutorial.encoder.TestCoderImpl&lt;/<span class="type">class</span>&gt;
&lt;/<span class="class">alternatives</span>&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Save and close the file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn clean install</code></pre>
</div>
</div>
</li>
<li>
<p>In the web browser, reenter the URL to show the String Encoder page
for the redeployed project:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/encoder</span></code></pre>
</div>
</div>
</li>
<li>
<p>Enter a string and the number of letters to shift by, and then click
Encode.</p>
<div class="paragraph">
<p>This time, the Result line displays your arguments. For example, if you
enter <code>Java</code> and <code>4</code>, the result is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Result</span>: input string is Java, shift value is <span class="integer">4</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHPY"></a><a id="the-producermethods-example-using-a-producer-method-to-choose-a-bean-implementation"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_producermethods_example_using_a_producer_method_to_choose_a_bean_implementation">6.3. The producermethods Example: Using a Producer Method to Choose a Bean Implementation</h3>
<div class="paragraph">
<p>The <code>producermethods</code> example shows how to use a producer method to
choose between two beans at runtime, as described in
<a href="#GKGKV">Using Producer Methods, Producer Fields, and
Disposer Methods in CDI Applications</a>. It is very similar to the
<code>encoder</code> example described in <a href="#GKHPU">The
encoder Example: Using Alternatives</a>. The example includes the same
interface and two implementations of it, a managed bean, a Facelets
page, and configuration files. It also contains a qualifier type. When
you run it, you do not need to edit the <code>beans.xml</code> file and redeploy
the application to change its behavior.</p>
</div>
<div class="paragraph">
<p><a id="GKHRO"></a><a id="components-of-the-producermethods-example"></a></p>
</div>
<div class="sect3">
<h4 id="_components_of_the_producermethods_example">6.3.1. Components of the producermethods Example</h4>
<div class="paragraph">
<p>The components of <code>producermethods</code> are very much like those for
<code>encoder</code>, with some significant differences.</p>
</div>
<div class="paragraph">
<p>Neither implementation of the <code>Coder</code> bean is annotated <code>@Alternative</code>,
and there is no <code>beans.xml</code> file, because it is not needed.</p>
</div>
<div class="paragraph">
<p>The Facelets page and the managed bean, <code>CoderBean</code>, have an additional
property, <code>coderType</code>, that allows the user to specify at runtime which
implementation to use. In addition, the managed bean has a producer
method that selects the implementation using a qualifier type,
<code>@Chosen</code>.</p>
</div>
<div class="paragraph">
<p>The bean declares two constants that specify whether the coder type is
the test implementation or the implementation that actually shifts
letters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">private</span> <span class="directive">final</span> <span class="directive">static</span> <span class="type">int</span> TEST = <span class="integer">1</span>;
    <span class="directive">private</span> <span class="directive">final</span> <span class="directive">static</span> <span class="type">int</span> SHIFT = <span class="integer">2</span>;
    <span class="directive">private</span> <span class="type">int</span> coderType = SHIFT; <span class="comment">// default value</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The producer method, annotated with <code>@Produces</code> and <code>@Chosen</code> as well as
<code>@RequestScoped</code> (so that it lasts only for the duration of a single
request and response), returns one of the two implementations based on
the <code>coderType</code> supplied by the user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Produces</span>
    <span class="annotation">@Chosen</span>
    <span class="annotation">@RequestScoped</span>
    <span class="directive">public</span> Coder getCoder() {

        <span class="keyword">switch</span> (coderType) {
            <span class="keyword">case</span> TEST:
                <span class="keyword">return</span> <span class="keyword">new</span> TestCoderImpl();
            <span class="keyword">case</span> SHIFT:
                <span class="keyword">return</span> <span class="keyword">new</span> CoderImpl();
            <span class="keyword">default</span>:
                <span class="keyword">return</span> <span class="predefined-constant">null</span>;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the managed bean injects the chosen implementation, specifying
the same qualifier as that returned by the producer method to resolve
ambiguities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Inject</span>
    <span class="annotation">@Chosen</span>
    <span class="annotation">@RequestScoped</span>
    Coder coder;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Facelets page contains modified instructions and a pair of options
whose selected value is assigned to the property <code>coderBean.coderType</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;h2&gt;</span>String Encoder<span class="tag">&lt;/h2&gt;</span>
        <span class="tag">&lt;p&gt;</span>Select Test or Shift, type a string and an integer, then click
            Encode.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;p&gt;</span>If you select Test, the TestCoderImpl bean will display the
            argument values.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;p&gt;</span>If you select Shift, the CoderImpl bean will return a string that
            shifts the letters in the original string by the value you specify.
            The value must be between 0 and 26.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">encodeit</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;h:selectOneRadio</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">coderType</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{coderBean.coderType}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;f:selectItem</span>
                    <span class="attribute-name">itemValue</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">itemLabel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Test</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;f:selectItem</span>
                    <span class="attribute-name">itemValue</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">itemLabel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Shift Letters</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/h:selectOneRadio&gt;</span>
            ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKHQE"></a><a id="running-the-producermethods-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_producermethods_example">6.3.2. Running the producermethods Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>producermethods</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GKHPE"></a><a id="to-build-package-and-deploy-the-producermethods-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_producermethods_example_using_netbeans_ide">To Build, Package, and Deploy the producermethods Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>producermethods</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>producermethods</code> project and
select Build.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>producermethods.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHPS"></a><a id="to-build-package-and-deploy-the-producermethods-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_producermethods_example_using_maven">To Build, Package, and Deploy the producermethods Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/producermethods/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>producermethods.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHQG"></a><a id="to-run-the-producermethods-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_producermethods_example">To Run the producermethods Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/producermethods</span></code></pre>
</div>
</div>
</li>
<li>
<p>On the String Encoder page, select either the Test or Shift Letters
option, enter a string and the number of letters to shift by, and then
click Encode.</p>
<div class="paragraph">
<p>Depending on your selection, the Result line displays either the encoded
string or the input values you specified.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHRG"></a><a id="the-producerfields-example-using-producer-fields-to-generate-resources"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_producerfields_example_using_producer_fields_to_generate_resources">6.4. The producerfields Example: Using Producer Fields to Generate Resources</h3>
<div class="paragraph">
<p>The <code>producerfields</code> example, which allows you to create a to-do list,
shows how to use a producer field to generate objects that can then be
managed by the container. This example generates an <code>EntityManager</code>
object, but resources such as JDBC connections and datasources can also
be generated this way.</p>
</div>
<div class="paragraph">
<p>The <code>producerfields</code> example is the simplest possible entity example. It
also contains a qualifier and a class that generates the entity manager.
It also contains a single entity, a stateful session bean, a Facelets
page, and a managed bean.</p>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/producerfields/src/main/java/ee/jakarta/tutorial/producerfields/</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="GKHPP"></a><a id="the-producer-field-for-the-producerfields-example"></a></p>
</div>
<div class="sect3">
<h4 id="_the_producer_field_for_the_producerfields_example">6.4.1. The Producer Field for the producerfields Example</h4>
<div class="paragraph">
<p>The most important component of the <code>producerfields</code> example is the
smallest, the <code>db.UserDatabaseEntityManager</code> class, which isolates the
generation of the <code>EntityManager</code> object so it can easily be used by
other components in the application. The class uses a producer field to
inject an <code>EntityManager</code> annotated with the <code>@UserDatabase</code> qualifier,
also defined in the <code>db</code> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Singleton</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">UserDatabaseEntityManager</span> {

    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceContext</span>
    <span class="annotation">@UserDatabase</span>
    <span class="directive">private</span> EntityManager em;
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class does not explicitly produce a persistence unit field, but the
application has a <code>persistence.xml</code> file that specifies a persistence
unit. The class is annotated <code>javax.inject.Singleton</code> to specify that
the injector should instantiate it only once.</p>
</div>
<div class="paragraph">
<p>The <code>db.UserDatabaseEntityManager</code> class also contains commented-out
code that uses <code>create</code> and <code>close</code> methods to generate and remove the
producer field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="comment">/* @PersistenceContext
    private EntityManager em;

    @Produces
    @UserDatabase
    public EntityManager create() {
        return em;
    } */</span>

    <span class="directive">public</span> <span class="type">void</span> close(<span class="annotation">@Disposes</span> <span class="annotation">@UserDatabase</span> EntityManager em) {
        em.close();
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can remove the comment indicators from this code and place them
around the field declaration to test how the methods work. The behavior
of the application is the same with either mechanism.</p>
</div>
<div class="paragraph">
<p>The advantage of producing the <code>EntityManager</code> in a separate class
rather than simply injecting it into an enterprise bean is that the
object can easily be reused in a typesafe way. Also, a more complex
application can create multiple entity managers using multiple
persistence units, and this mechanism isolates this code for easy
maintenance, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Singleton</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JPAResourceProducer</span> {
    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceUnit</span>(unitName=<span class="string"><span class="delimiter">&quot;</span><span class="content">pu3</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@TestDatabase</span>
    EntityManagerFactory customerDatabasePersistenceUnit;

    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceContext</span>(unitName=<span class="string"><span class="delimiter">&quot;</span><span class="content">pu3</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@TestDatabase</span>
    EntityManager customerDatabasePersistenceContext;

    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceUnit</span>(unitName=<span class="string"><span class="delimiter">&quot;</span><span class="content">pu4</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Documents</span>
    EntityManagerFactory customerDatabasePersistenceUnit;

    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceContext</span>(unitName=<span class="string"><span class="delimiter">&quot;</span><span class="content">pu4</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Documents</span>
    EntityManager docDatabaseEntityManager;<span class="string"><span class="delimiter">&quot;</span><span class="content">
}</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>EntityManagerFactory</code> declarations also allow applications to use
an application-managed entity manager.</p>
</div>
<div class="paragraph">
<p><a id="GKHPD"></a><a id="the-producerfields-entity-and-session-bean"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_producerfields_entity_and_session_bean">6.4.2. The producerfields Entity and Session Bean</h4>
<div class="paragraph">
<p>The <code>producerfields</code> example contains a simple entity class,
<code>entity.ToDo</code>, and a stateful session bean, <code>ejb.RequestBean</code>, that uses
it.</p>
</div>
<div class="paragraph">
<p>The entity class contains three fields: an autogenerated <code>id</code> field, a
string specifying the task, and a timestamp. The timestamp field,
<code>timeCreated</code>, is annotated with <code>@Temporal</code>, which is required for
persistent <code>Date</code> fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ToDo</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    ...
    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>(strategy = GenerationType.AUTO)
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">protected</span> <span class="predefined-type">String</span> taskText;
    <span class="annotation">@Temporal</span>(TIMESTAMP)
    <span class="directive">protected</span> <span class="predefined-type">Date</span> timeCreated;

    <span class="directive">public</span> ToDo() {
    }

    <span class="directive">public</span> ToDo(<span class="predefined-type">Long</span> id, <span class="predefined-type">String</span> taskText, <span class="predefined-type">Date</span> timeCreated) {
        <span class="local-variable">this</span>.id = id;
        <span class="local-variable">this</span>.taskText = taskText;
        <span class="local-variable">this</span>.timeCreated = timeCreated;
    }
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The remainder of the <code>ToDo</code> class contains the usual getters, setters,
and other entity methods.</p>
</div>
<div class="paragraph">
<p>The <code>RequestBean</code> class injects the <code>EntityManager</code> generated by the
producer method, annotated with the <code>@UserDatabase</code> qualifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ConversationScoped</span>
<span class="annotation">@Stateful</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RequestBean</span> {

    <span class="annotation">@Inject</span>
    <span class="annotation">@UserDatabase</span>
    EntityManager em;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It then defines two methods, one that creates and persists a single
<code>ToDo</code> list item, and another that retrieves all the <code>ToDo</code> items
created so far by creating a query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> ToDo createToDo(<span class="predefined-type">String</span> inputString) {
        ToDo toDo = <span class="predefined-constant">null</span>;
        <span class="predefined-type">Date</span> currentTime = <span class="predefined-type">Calendar</span>.getInstance().getTime();

        <span class="keyword">try</span> {
            toDo = <span class="keyword">new</span> ToDo();
            toDo.setTaskText(inputString);
            toDo.setTimeCreated(currentTime);
            em.persist(toDo);
            <span class="keyword">return</span> toDo;
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> EJBException(e.getMessage());
        }
    }

    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDo&gt; getToDos() {
        <span class="keyword">try</span> {
             <span class="predefined-type">List</span>&lt;ToDo&gt; toDos =
                    (<span class="predefined-type">List</span>&lt;ToDo&gt;) em.createQuery(
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT t FROM ToDo t ORDER BY t.timeCreated</span><span class="delimiter">&quot;</span></span>)
                    .getResultList();
            <span class="keyword">return</span> toDos;
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> EJBException(e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKHPF"></a><a id="the-producerfields-facelets-pages-and-managed-bean"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_producerfields_facelets_pages_and_managed_bean">6.4.3. The producerfields Facelets Pages and Managed Bean</h4>
<div class="paragraph">
<p>The <code>producerfields</code> example has two Facelets pages, <code>index.xhtml</code> and
<code>todolist.xhtml</code>. The simple form on the <code>index.xhtml</code> page asks the
user only for the task. When the user clicks the Submit button, the
<code>listBean.createTask</code> method is called. When the user clicks the Show
Items button, the action specifies that the <code>todolist.xhtml</code> file should
be displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;h:body&gt;</span>
        <span class="tag">&lt;h2&gt;</span>To Do List<span class="tag">&lt;/h2&gt;</span>
        <span class="tag">&lt;p&gt;</span>Enter a task to be completed.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">todolist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter a string: </span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputString</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputString</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{listBean.inputString}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Submit</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{listBean.createTask()}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Show Items</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">todolist</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        ...
    <span class="tag">&lt;/h:body&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The managed bean, <code>web.ListBean</code>, injects the <code>ejb.RequestBean</code> session
bean. It declares the <code>entity.ToDo</code> entity and a list of the entity
along with the input string that it passes to the session bean. The
<code>inputString</code> is annotated with the <code>@NotNull</code> Bean Validation
constraint, so an attempt to submit an empty string results in an error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>
<span class="annotation">@ConversationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ListBean</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    ...
    <span class="annotation">@EJB</span>
    <span class="directive">private</span> RequestBean request;
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> inputString;
    <span class="directive">private</span> ToDo toDo;
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;ToDo&gt; toDos;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>createTask</code> method called by the Submit button calls the
<code>createToDo</code> method of <code>RequestBean</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">void</span> createTask() {
        <span class="local-variable">this</span>.toDo = request.createToDo(inputString);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>getToDos</code> method, which is called by the <code>todolist.xhtml</code> page,
calls the <code>getToDos</code> method of <code>RequestBean</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDo&gt; getToDos() {
        <span class="keyword">return</span> request.getToDos();
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>To force the Facelets page to recognize an empty string as a null value
and return an error, the <code>web.xml</code> file sets the context parameter
<code>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL</code> to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
  <span class="tag">&lt;param-name&gt;</span>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL<span class="tag">&lt;/param-name&gt;</span>
  <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>todolist.xhtml</code> page is a little more complicated than the
<code>index.html</code> page. It contains a <code>dataTable</code> element that displays the
contents of the <code>ToDo</code> list. The body of the page looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;body&gt;</span>
        <span class="tag">&lt;h2&gt;</span>To Do List<span class="tag">&lt;/h2&gt;</span>
        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">showlist</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;h:dataTable</span> <span class="attribute-name">var</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">toDo</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{listBean.toDos}</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">rules</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">border</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">cellpadding</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;h:column&gt;</span>
                    <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Time Stamp</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                    <span class="tag">&lt;/f:facet&gt;</span>
                    <span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{toDo.timeCreated}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;/h:column&gt;</span>
                <span class="tag">&lt;h:column&gt;</span>
                    <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Task</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                    <span class="tag">&lt;/f:facet&gt;</span>
                    <span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{toDo.taskText}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;/h:dataTable&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">back</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Back</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
    <span class="tag">&lt;/body&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of the <code>dataTable</code> is <code>listBean.toDos</code>, the list returned by
the managed bean&#8217;s <code>getToDos</code> method, which in turn calls the session
bean&#8217;s <code>getToDos</code> method. Each row of the table displays the
<code>timeCreated</code> and <code>taskText</code> fields of the individual task. Finally, a
Back button returns the user to the <code>index.xhtml</code> page.</p>
</div>
<div class="paragraph">
<p><a id="GKHRH"></a><a id="running-the-producerfields-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_producerfields_example">6.4.4. Running the producerfields Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>producerfields</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GKHPB"></a><a id="to-build-package-and-deploy-the-producerfields-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_producerfields_example_using_netbeans_ide">To Build, Package, and Deploy the producerfields Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>If the database server is not already running, start it by following
the instructions in <a href="#BNADK">Starting and
Stopping Apache Derby</a>.</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>producerfields</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>producerfields</code> project and
select Build.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>producerfields.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHRM"></a><a id="to-build-package-and-deploy-the-producerfields-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_producerfields_example_using_maven">To Build, Package, and Deploy the producerfields Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>If the database server is not already running, start it by following
the instructions in <a href="#BNADK">Starting and
Stopping Apache Derby</a>.</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/producerfields/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>producerfields.war</code>, located in the <code>target</code> directory, and then
deploys it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHRR"></a><a id="to-run-the-producerfields-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_producerfields_example">To Run the producerfields Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/producerfields</span></code></pre>
</div>
</div>
</li>
<li>
<p>On the Create To Do List page, enter a string in the field and click
Submit.</p>
<div class="paragraph">
<p>You can enter additional strings and click Submit to create a task list
with multiple items.</p>
</div>
</li>
<li>
<p>Click Show Items.</p>
<div class="paragraph">
<p>The To Do List page opens, showing the timestamp and text for each item
you created.</p>
</div>
</li>
<li>
<p>Click Back to return to the Create To Do List page.</p>
<div class="paragraph">
<p>On this page, you can enter more items in the list.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHPA"></a><a id="the-billpayment-example-using-events-and-interceptors"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_billpayment_example_using_events_and_interceptors">6.5. The billpayment Example: Using Events and Interceptors</h3>
<div class="paragraph">
<p>The <code>billpayment</code> example shows how to use both events and interceptors.</p>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/billpayment/src/main/java/ee/jakarta/tutorial/billpayment/</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="CHDIBGDF"></a><a id="overview-of-the-billpayment-example"></a></p>
</div>
<div class="sect3">
<h4 id="_overview_of_the_billpayment_example">6.5.1. Overview of the billpayment Example</h4>
<div class="paragraph">
<p>The example simulates paying an amount using a debit card or credit
card. When the user chooses a payment method, the managed bean creates
an appropriate event, supplies its payload, and fires it. A simple event
listener handles the event using observer methods.</p>
</div>
<div class="paragraph">
<p>The example also defines an interceptor that is set on a class and on
two methods of another class.</p>
</div>
<div class="paragraph">
<p><a id="GKHOK"></a><a id="the-paymentevent-event-class"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_paymentevent_event_class">6.5.2. The PaymentEvent Event Class</h4>
<div class="paragraph">
<p>The event class, <code>event.PaymentEvent</code>, is a simple bean class that
contains a no-argument constructor. It also has a <code>toString</code> method and
getter and setter methods for the payload components: a <code>String</code> for the
payment type, a <code>BigDecimal</code> for the payment amount, and a <code>Date</code> for
the timestamp.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">PaymentEvent</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    ...
    public <span class="predefined-type">String</span> paymentType;
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> value;
    <span class="directive">public</span> <span class="predefined-type">Date</span> datetime;

    <span class="directive">public</span> PaymentEvent() {
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.paymentType
                + <span class="string"><span class="delimiter">&quot;</span><span class="content"> = $</span><span class="delimiter">&quot;</span></span> + <span class="local-variable">this</span>.value.toString()
                + <span class="string"><span class="delimiter">&quot;</span><span class="content"> at </span><span class="delimiter">&quot;</span></span> + <span class="local-variable">this</span>.datetime.toString();
    }
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event class is a simple bean that is instantiated by the managed
bean using <code>new</code> and then populated. For this reason, the CDI container
cannot intercept the creation of the bean, and hence it cannot allow
interception of its getter and setter methods.</p>
</div>
<div class="paragraph">
<p><a id="GKHRB"></a><a id="the-paymenthandler-event-listener"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_paymenthandler_event_listener">6.5.3. The PaymentHandler Event Listener</h4>
<div class="paragraph">
<p>The event listener, <code>listener.PaymentHandler</code>, contains two observer
methods, one for each of the two event types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Logged</span>
<span class="annotation">@SessionScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PaymentHandler</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    ...
    public <span class="type">void</span> creditPayment(<span class="annotation">@Observes</span> <span class="annotation">@Credit</span> PaymentEvent event) {
        logger.log(<span class="predefined-type">Level</span>.INFO, <span class="string"><span class="delimiter">&quot;</span><span class="content">PaymentHandler - Credit Handler: {0}</span><span class="delimiter">&quot;</span></span>,
                event.toString());

        <span class="comment">// call a specific Credit handler class...</span>
    }

    <span class="directive">public</span> <span class="type">void</span> debitPayment(<span class="annotation">@Observes</span> <span class="annotation">@Debit</span> PaymentEvent event) {
        logger.log(<span class="predefined-type">Level</span>.INFO, <span class="string"><span class="delimiter">&quot;</span><span class="content">PaymentHandler - Debit Handler: {0}</span><span class="delimiter">&quot;</span></span>,
                event.toString());

        <span class="comment">// call a specific Debit handler class...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each observer method takes as an argument the event, annotated with
<code>@Observes</code> and with the qualifier for the type of payment. In a real
application, the observer methods would pass the event information on to
another component that would perform business logic on the payment.</p>
</div>
<div class="paragraph">
<p>The qualifiers are defined in the <code>payment</code> package, described in
<a href="#GKHRJ">The billpayment Facelets Pages and Managed Bean</a>.</p>
</div>
<div class="paragraph">
<p>The <code>PaymentHandler</code> bean is annotated <code>@Logged</code> so that all its methods
can be intercepted.</p>
</div>
<div class="paragraph">
<p><a id="GKHRJ"></a><a id="the-billpayment-facelets-pages-and-managed-bean"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_billpayment_facelets_pages_and_managed_bean">6.5.4. The billpayment Facelets Pages and Managed Bean</h4>
<div class="paragraph">
<p>The <code>billpayment</code> example contains two Facelets pages, <code>index.xhtml</code> and
the very simple <code>response.xhtml</code>. The body of <code>index.xhtml</code> looks like
this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;h:body&gt;</span>
        <span class="tag">&lt;h3&gt;</span>Bill Payment Options<span class="tag">&lt;/h3&gt;</span>
        <span class="tag">&lt;p&gt;</span>Enter an amount, select Debit Card or Credit Card,
            then click Pay.<span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;h:form&gt;</span>
            <span class="tag">&lt;p&gt;</span>
            <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Amount: $</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">amt</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">amt</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.value}</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">requiredMessage</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">An amount is required.</span><span class="delimiter">&quot;</span></span>
                         <span class="attribute-name">maxlength</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">15</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Options:</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opt</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;h:selectOneRadio</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opt</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.paymentOption}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;f:selectItem</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">debit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">itemLabel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Debit Card</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">itemValue</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;f:selectItem</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">itemLabel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Credit Card</span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">itemValue</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/h:selectOneRadio&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">submit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Pay</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.pay}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Reset</span><span class="delimiter">&quot;</span></span>
                                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.reset}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        ...
    <span class="tag">&lt;/h:body&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The input field takes a payment amount, passed to <code>paymentBean.value</code>.
Two options ask the user to select a Debit Card or Credit Card payment,
passing the integer value to <code>paymentBean.paymentOption</code>. Finally, the
Pay command button&#8217;s action is set to the method <code>paymentBean.pay</code>, and
the Reset button&#8217;s action is set to the <code>paymentBean.reset</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>payment.PaymentBean</code> managed bean uses qualifiers to differentiate
between the two kinds of payment event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>
<span class="annotation">@SessionScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PaymentBean</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

   ...
    <span class="annotation">@Inject</span>
    <span class="annotation">@Credit</span>
    <span class="predefined-type">Event</span>&lt;PaymentEvent&gt; creditEvent;

    <span class="annotation">@Inject</span>
    <span class="annotation">@Debit</span>
    <span class="predefined-type">Event</span>&lt;PaymentEvent&gt; debitEvent;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The qualifiers, <code>@Credit</code> and <code>@Debit</code>, are defined in the <code>payment</code>
package along with <code>PaymentBean</code>.</p>
</div>
<div class="paragraph">
<p>Next, the <code>PaymentBean</code> defines the properties it obtains from the
Facelets page and will pass on to the event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">int</span> DEBIT = <span class="integer">1</span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">int</span> CREDIT = <span class="integer">2</span>;
    <span class="directive">private</span> <span class="type">int</span> paymentOption = DEBIT;

    <span class="annotation">@Digits</span>(integer = <span class="integer">10</span>, fraction = <span class="integer">2</span>, message = <span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid value</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">BigDecimal</span> value;

    <span class="directive">private</span> <span class="predefined-type">Date</span> datetime;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>paymentOption</code> value is an integer passed in from the option
component; the default value is <code>DEBIT</code>. The <code>value</code> is a <code>BigDecimal</code>
with a Bean Validation constraint that enforces a currency value with a
maximum number of digits. The timestamp for the event, <code>datetime</code>, is a
<code>Date</code> object initialized when the <code>pay</code> method is called.</p>
</div>
<div class="paragraph">
<p>The <code>pay</code> method of the bean first sets the timestamp for this payment
event. It then creates and populates the event payload, using the
constructor for the <code>PaymentEvent</code> and calling the event&#8217;s setter
methods, using the bean properties as arguments. It then fires the
event.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Logged</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> pay() {
        <span class="local-variable">this</span>.setDatetime(<span class="predefined-type">Calendar</span>.getInstance().getTime());
        <span class="keyword">switch</span> (paymentOption) {
            <span class="keyword">case</span> DEBIT:
                PaymentEvent debitPayload = <span class="keyword">new</span> PaymentEvent();
                debitPayload.setPaymentType(<span class="string"><span class="delimiter">&quot;</span><span class="content">Debit</span><span class="delimiter">&quot;</span></span>);
                debitPayload.setValue(value);
                debitPayload.setDatetime(datetime);
                debitEvent.fire(debitPayload);
                <span class="keyword">break</span>;
            <span class="keyword">case</span> CREDIT:
                PaymentEvent creditPayload = <span class="keyword">new</span> PaymentEvent();
                creditPayload.setPaymentType(<span class="string"><span class="delimiter">&quot;</span><span class="content">Credit</span><span class="delimiter">&quot;</span></span>);
                creditPayload.setValue(value);
                creditPayload.setDatetime(datetime);
                creditEvent.fire(creditPayload);
                <span class="keyword">break</span>;
            <span class="keyword">default</span>:
                logger.severe(<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid payment option!</span><span class="delimiter">&quot;</span></span>);
        }
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">response</span><span class="delimiter">&quot;</span></span>;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>pay</code> method returns the page to which the action is redirected,
<code>response.xhtml</code>.</p>
</div>
<div class="paragraph">
<p>The <code>PaymentBean</code> class also contains a <code>reset</code> method that empties the
value field on the <code>index.xhtml</code> page and sets the payment option to the
default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Logged</span>
    <span class="directive">public</span> <span class="type">void</span> reset() {
        setPaymentOption(DEBIT);
        setValue(<span class="predefined-type">BigDecimal</span>.ZERO);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this bean, only the <code>pay</code> and <code>reset</code> methods are intercepted.</p>
</div>
<div class="paragraph">
<p>The <code>response.xhtml</code> page displays the amount paid. It uses a <code>rendered</code>
expression to display the payment method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;h:body&gt;</span>
        <span class="tag">&lt;h:form&gt;</span>
            <span class="tag">&lt;h2&gt;</span>Bill Payment: Result<span class="tag">&lt;/h2&gt;</span>
            <span class="tag">&lt;h3&gt;</span>Amount Paid with
                <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">debit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Debit Card: </span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.paymentOption eq 1}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">credit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Credit Card: </span><span class="delimiter">&quot;</span></span>
                              <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.paymentOption eq 2}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{paymentBean.value}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;f:convertNumber</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/h:outputText&gt;</span>
            <span class="tag">&lt;/h3&gt;</span>
            <span class="tag">&lt;p&gt;</span><span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">back</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Back</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
    <span class="tag">&lt;/h:body&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKHRQ"></a><a id="the-loggedinterceptor-interceptor-class"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_the_loggedinterceptor_interceptor_class">6.5.5. The LoggedInterceptor Interceptor Class</h4>
<div class="paragraph">
<p>The interceptor class, <code>LoggedInterceptor</code>, and its interceptor binding,
<code>Logged</code>, are both defined in the <code>interceptor</code> package. The <code>Logged</code>
interceptor binding is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inherited</span>
<span class="annotation">@InterceptorBinding</span>
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>({METHOD, TYPE})
<span class="directive">public</span> <span class="annotation">@interface</span> Logged {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LoggedInterceptor</code> class looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Logged</span>
<span class="annotation">@Interceptor</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LoggedInterceptor</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    ...

    public LoggedInterceptor() {
    }

    <span class="annotation">@AroundInvoke</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> logMethodEntry(InvocationContext invocationContext)
            <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Entering method: </span><span class="delimiter">&quot;</span></span>
                + invocationContext.getMethod().getName() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> in class </span><span class="delimiter">&quot;</span></span>
                + invocationContext.getMethod().getDeclaringClass().getName());

        <span class="keyword">return</span> invocationContext.proceed();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class is annotated with both the <code>@Logged</code> and the <code>@Interceptor</code>
annotations. The <code>@AroundInvoke</code> method, <code>logMethodEntry</code>, takes the
required <code>InvocationContext</code> argument and calls the required <code>proceed</code>
method. When a method is intercepted, <code>logMethodEntry</code> displays the name
of the method being invoked as well as its class.</p>
</div>
<div class="paragraph">
<p>To enable the interceptor, the <code>beans.xml</code> file defines it as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;interceptors&gt;</span>
    <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.billpayment.interceptor.LoggedInterceptor<span class="tag">&lt;/class&gt;</span>
<span class="tag">&lt;/interceptors&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this application, the <code>PaymentEvent</code> and <code>PaymentHandler</code> classes are
annotated <code>@Logged</code>, so all their methods are intercepted. In
<code>PaymentBean</code>, only the <code>pay</code> and <code>reset</code> methods are annotated
<code>@Logged</code>, so only those methods are intercepted.</p>
</div>
<div class="paragraph">
<p><a id="GKHPK"></a><a id="running-the-billpayment-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_billpayment_example">6.5.6. Running the billpayment Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>billpayment</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GKHQS"></a><a id="to-build-package-and-deploy-the-billpayment-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_billpayment_example_using_netbeans_ide">To Build, Package, and Deploy the billpayment Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>billpayment</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>billpayment</code> project and
select Build.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>billpayment.war</code>, located in the <code>target</code> directory, and then deploys
it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHPX"></a><a id="to-build-package-and-deploy-the-billpayment-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_billpayment_example_using_maven">To Build, Package, and Deploy the billpayment Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/billpayment/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>billpayment.war</code>, located in the <code>target</code> directory, and then deploys
it to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKHPT"></a><a id="to-run-the-billpayment-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_billpayment_example">To Run the billpayment Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/billpayment</span></code></pre>
</div>
</div>
</li>
<li>
<p>On the Bill Payment Options page, enter a value in the Amount field.</p>
<div class="paragraph">
<p>The amount can contain up to 10 digits and include up to two decimal
places. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="float">9876.54</span></code></pre>
</div>
</div>
</li>
<li>
<p>Select Debit Card or Credit Card and click Pay.</p>
<div class="paragraph">
<p>The Bill Payment: Result page opens, displaying the amount paid and the
method of payment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Amount Paid with Credit Card: <span class="error">$</span><span class="integer">9</span>,<span class="float">876.34</span></code></pre>
</div>
</div>
</li>
<li>
<p>Click Back to return to the Bill Payment Options page.</p>
<div class="paragraph">
<p>You can also click Reset to return to the initial page values.</p>
</div>
</li>
<li>
<p>Examine the server log output.</p>
<div class="paragraph">
<p>In NetBeans IDE, the output is visible in the GlassFish Server Output
tab. Otherwise, view domain-dir`/logs/server.log`.</p>
</div>
<div class="paragraph">
<p>The output from each interceptor appears in the log, followed by the
additional logger output defined by the constructor and methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">INFO: Entering method: pay in <span class="type">class</span> <span class="class">billpayment</span>.payment.PaymentBean
INFO: PaymentHandler created.
INFO: Entering method: debitPayment in <span class="type">class</span> <span class="class">billpayment</span>.listener.PaymentHandler
INFO: PaymentHandler - Debit <span class="predefined-type">Handler</span>: Debit = <span class="error">$</span><span class="float">1234.56</span> at Tue Dec <span class="integer">14</span> <span class="integer">14</span>:<span class="integer">50</span>:<span class="integer">28</span> EST <span class="integer">2010</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKPAX"></a><a id="the-decorators-example-decorating-a-bean"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_decorators_example_decorating_a_bean">6.6. The decorators Example: Decorating a Bean</h3>
<div class="paragraph">
<p>The <code>decorators</code> example, which is yet another variation on the
<code>encoder</code> example, shows how to use a decorator to implement additional
business logic for a bean.</p>
</div>
<div class="paragraph">
<p>The source files are located in the
<code><em>tut-install</em>/examples/cdi/decorators/src/main/java/ee/jakarta/tutorial/decorators/</code>
directory.</p>
</div>
<div class="paragraph">
<p><a id="CHDDDFCI"></a><a id="overview-of-the-decorators-example"></a></p>
</div>
<div class="sect3">
<h4 id="_overview_of_the_decorators_example">6.6.1. Overview of the decorators Example</h4>
<div class="paragraph">
<p>Instead of having the user choose between two alternative
implementations of an interface at deployment time or runtime, a
decorator adds some additional logic to a single implementation of the
interface.</p>
</div>
<div class="paragraph">
<p>The example includes an interface, an implementation of it, a decorator,
an interceptor, a managed bean, a Facelets page, and configuration
files.</p>
</div>
<div class="paragraph">
<p><a id="GKPAQ"></a><a id="components-of-the-decorators-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_components_of_the_decorators_example">6.6.2. Components of the decorators Example</h4>
<div class="paragraph">
<p>The <code>decorators</code> example is very similar to the <code>encoder</code> example
described in <a href="#GKHPU">The encoder Example:
Using Alternatives</a>. Instead of providing two implementations of the
<code>Coder</code> interface, however, this example provides only the <code>CoderImpl</code>
class. The decorator class, <code>CoderDecorator</code>, rather than simply return
the coded string, displays the input and output strings' values and
length.</p>
</div>
<div class="paragraph">
<p>The <code>CoderDecorator</code> class, like <code>CoderImpl</code>, implements the business
method of the <code>Coder</code> interface, <code>codeString</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Decorator</span>
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">CoderDecorator</span> <span class="directive">implements</span> Coder {

    <span class="annotation">@Inject</span>
    <span class="annotation">@Delegate</span>
    <span class="annotation">@Any</span>
    Coder coder;

    <span class="directive">public</span> <span class="predefined-type">String</span> codeString(<span class="predefined-type">String</span> s, <span class="type">int</span> tval) {
        <span class="type">int</span> len = s.length();

        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span> + s + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content"> becomes </span><span class="delimiter">&quot;</span></span> + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span> + coder.codeString(s, tval)
                + <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span> + len + <span class="string"><span class="delimiter">&quot;</span><span class="content"> characters in length</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decorator&#8217;s <code>codeString</code> method calls the delegate object&#8217;s
<code>codeString</code> method to perform the actual encoding.</p>
</div>
<div class="paragraph">
<p>The <code>decorators</code> example includes the <code>Logged</code> interceptor binding and
<code>LoggedInterceptor</code> class from the <code>billpayment</code> example. For this
example, the interceptor is set on the <code>CoderBean.encodeString</code> method
and the <code>CoderImpl.codeString</code> method. The interceptor code is
unchanged; interceptors are usually reusable for different applications.</p>
</div>
<div class="paragraph">
<p>Except for the interceptor annotations, the <code>CoderBean</code> and <code>CoderImpl</code>
classes are identical to the versions in the <code>encoder</code> example.</p>
</div>
<div class="paragraph">
<p>The <code>beans.xml</code> file specifies both the decorator and the interceptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;decorators&gt;</span>
        <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.decorators.CoderDecorator<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/decorators&gt;</span>
    <span class="tag">&lt;interceptors&gt;</span>
        <span class="tag">&lt;class&gt;</span>ee.jakarta.tutorial.decorators.LoggedInterceptor<span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/interceptors&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GKPBK"></a><a id="running-the-decorators-example"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_decorators_example">6.6.3. Running the decorators Example</h4>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and
run the <code>decorators</code> application.</p>
</div>
<div class="paragraph">
<p><a id="GKPAG"></a><a id="to-build-package-and-deploy-the-decorators-example-using-netbeans-ide"></a></p>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_decorators_example_using_netbeans_ide">To Build, Package, and Deploy the decorators Example Using NetBeans IDE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>decorators</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>decorators</code> project and select
Build.</p>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>decorators.war</code>, located in the <code>target</code> directory, and then deploys it
to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKPAJ"></a><a id="to-build-package-and-deploy-the-decorators-example-using-maven"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_build_package_and_deploy_the_decorators_example_using_maven">To Build, Package, and Deploy the decorators Example Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see
<a href="#BNADI">Starting and Stopping GlassFish
Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">tut-install/examples/cdi/decorators/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file,
<code>decorators.war</code>, located in the <code>target</code> directory, and then deploys it
to GlassFish Server.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKPAN"></a><a id="to-run-the-decorators-example"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_to_run_the_decorators_example">To Run the decorators Example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, enter the following URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">http:<span class="comment">//localhost:8080/decorators</span></code></pre>
</div>
</div>
</li>
<li>
<p>On the Decorated String Encoder page, enter a string and the number
of letters to shift by, and then click Encode.</p>
<div class="paragraph">
<p>The output from the decorator method appears in blue on the Result line.
For example, if you entered <code>Java</code> and <code>4</code>, you would see the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="string"><span class="delimiter">&quot;</span><span class="content">Java</span><span class="delimiter">&quot;</span></span> becomes <span class="string"><span class="delimiter">&quot;</span><span class="content">Neze</span><span class="delimiter">&quot;</span></span>, <span class="integer">4</span> characters in length</code></pre>
</div>
</div>
</li>
<li>
<p>Examine the server log output.</p>
<div class="paragraph">
<p>In NetBeans IDE, the output is visible in the GlassFish Server Output
tab. Otherwise, view domain-dir`/logs/server.log`.</p>
</div>
<div class="paragraph">
<p>The output from the interceptors appears:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">INFO: Entering method: encodeString in <span class="type">class</span> <span class="class">ee</span>.jakarta.tutorial.decorators.CoderBean
INFO: Entering method: codeString in <span class="type">class</span> <span class="class">ee</span>.jakarta.tutorial.decorators.CoderImpl</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-01-08 17:03:44 UTC
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</body>
</html>